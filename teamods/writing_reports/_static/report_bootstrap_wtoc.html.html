<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN"
   "http://www.w3.org/TR/html4/strict.dtd">

<html>
<head>
  <title></title>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <style type="text/css">
td.linenos { background-color: #f0f0f0; padding-right: 10px; }
span.lineno { background-color: #f0f0f0; padding: 0 5px 0 5px; }
pre { line-height: 125%; }
body .hll { background-color: #ffffcc }
body  { background: #f8f8f8; }
body .c { color: #008800; font-style: italic } /* Comment */
body  .err { border: 0; } /* drop error */
body .k { color: #AA22FF; font-weight: bold } /* Keyword */
body .o { color: #666666 } /* Operator */
body .cm { color: #008800; font-style: italic } /* Comment.Multiline */
body .cp { color: #008800 } /* Comment.Preproc */
body .c1 { color: #008800; font-style: italic } /* Comment.Single */
body .cs { color: #008800; font-weight: bold } /* Comment.Special */
body .gd { color: #A00000 } /* Generic.Deleted */
body .ge { font-style: italic } /* Generic.Emph */
body .gr { color: #FF0000 } /* Generic.Error */
body .gh { color: #000080; font-weight: bold } /* Generic.Heading */
body .gi { color: #00A000 } /* Generic.Inserted */
body .go { color: #888888 } /* Generic.Output */
body .gp { color: #000080; font-weight: bold } /* Generic.Prompt */
body .gs { font-weight: bold } /* Generic.Strong */
body .gu { color: #800080; font-weight: bold } /* Generic.Subheading */
body .gt { color: #0044DD } /* Generic.Traceback */
body .kc { color: #AA22FF; font-weight: bold } /* Keyword.Constant */
body .kd { color: #AA22FF; font-weight: bold } /* Keyword.Declaration */
body .kn { color: #AA22FF; font-weight: bold } /* Keyword.Namespace */
body .kp { color: #AA22FF } /* Keyword.Pseudo */
body .kr { color: #AA22FF; font-weight: bold } /* Keyword.Reserved */
body .kt { color: #00BB00; font-weight: bold } /* Keyword.Type */
body .m { color: #666666 } /* Literal.Number */
body .s { color: #BB4444 } /* Literal.String */
body .na { color: #BB4444 } /* Name.Attribute */
body .nb { color: #AA22FF } /* Name.Builtin */
body .nc { color: #0000FF } /* Name.Class */
body .no { color: #880000 } /* Name.Constant */
body .nd { color: #AA22FF } /* Name.Decorator */
body .ni { color: #999999; font-weight: bold } /* Name.Entity */
body .ne { color: #D2413A; font-weight: bold } /* Name.Exception */
body .nf { color: #00A000 } /* Name.Function */
body .nl { color: #A0A000 } /* Name.Label */
body .nn { color: #0000FF; font-weight: bold } /* Name.Namespace */
body .nt { color: #008000; font-weight: bold } /* Name.Tag */
body .nv { color: #B8860B } /* Name.Variable */
body .ow { color: #AA22FF; font-weight: bold } /* Operator.Word */
body .w { color: #bbbbbb } /* Text.Whitespace */
body .mb { color: #666666 } /* Literal.Number.Bin */
body .mf { color: #666666 } /* Literal.Number.Float */
body .mh { color: #666666 } /* Literal.Number.Hex */
body .mi { color: #666666 } /* Literal.Number.Integer */
body .mo { color: #666666 } /* Literal.Number.Oct */
body .sb { color: #BB4444 } /* Literal.String.Backtick */
body .sc { color: #BB4444 } /* Literal.String.Char */
body .sd { color: #BB4444; font-style: italic } /* Literal.String.Doc */
body .s2 { color: #BB4444 } /* Literal.String.Double */
body .se { color: #BB6622; font-weight: bold } /* Literal.String.Escape */
body .sh { color: #BB4444 } /* Literal.String.Heredoc */
body .si { color: #BB6688; font-weight: bold } /* Literal.String.Interpol */
body .sx { color: #008000 } /* Literal.String.Other */
body .sr { color: #BB6688 } /* Literal.String.Regex */
body .s1 { color: #BB4444 } /* Literal.String.Single */
body .ss { color: #B8860B } /* Literal.String.Symbol */
body .bp { color: #AA22FF } /* Name.Builtin.Pseudo */
body .vc { color: #B8860B } /* Name.Variable.Class */
body .vg { color: #B8860B } /* Name.Variable.Global */
body .vi { color: #B8860B } /* Name.Variable.Instance */
body .il { color: #666666 } /* Literal.Number.Integer.Long */

  </style>
</head>
<body>
<h2></h2>

<div class="highlight"><pre><span class="cp">&lt;!DOCTYPE html&gt;</span>
<span class="nt">&lt;html</span> <span class="na">lang=</span><span class="s">&quot;en&quot;</span><span class="nt">&gt;</span>
<span class="nt">&lt;head&gt;</span>
<span class="nt">&lt;meta</span> <span class="na">http-equiv=</span><span class="s">&quot;Content-Type&quot;</span> <span class="na">content=</span><span class="s">&quot;text/html; charset=UTF-8&quot;</span><span class="nt">&gt;</span>
<span class="nt">&lt;meta</span> <span class="na">charset=</span><span class="s">&quot;utf-8&quot;</span><span class="nt">&gt;</span>
<span class="nt">&lt;meta</span> <span class="na">http-equiv=</span><span class="s">&quot;X-UA-Compatible&quot;</span> <span class="na">content=</span><span class="s">&quot;IE=edge&quot;</span><span class="nt">&gt;</span>
<span class="nt">&lt;meta</span> <span class="na">name=</span><span class="s">&quot;viewport&quot;</span> <span class="na">content=</span><span class="s">&quot;width=device-width, initial-scale=1&quot;</span><span class="nt">&gt;</span>

<span class="nt">&lt;title&gt;</span>Experiments with Schemes for Exponential Decay<span class="nt">&lt;/title&gt;</span>

<span class="c">&lt;!-- Bootstrap style: http://getbootstrap.com/getting-started/</span>

<span class="c">What to change in this template:</span>

<span class="c">URL to the document (edit http://some.website.net/some/path)</span>

<span class="c">LINK1, LINK2 links in the navigation topbar (remove, edit, or add more)</span>

<span class="c">Footer with author(s) and copyright (remove or edit)</span>
<span class="c">--&gt;</span>

<span class="nt">&lt;link</span> <span class="na">href=</span><span class="s">&quot;http://getbootstrap.com/dist/css/bootstrap.min.css&quot;</span> <span class="na">rel=</span><span class="s">&quot;stylesheet&quot;</span>

<span class="err">&lt;!</span><span class="na">--</span> <span class="na">Can</span> <span class="na">add</span> <span class="na">other</span> <span class="na">themes</span> <span class="na">and</span> <span class="na">adjust</span> <span class="na">colors</span> <span class="na">in</span> <span class="na">the</span> <span class="na">navigation</span> <span class="na">sidebar</span> <span class="na">--</span><span class="nt">&gt;</span>
<span class="c">&lt;!--</span>
<span class="c">&lt;link href=&quot;http://netdna.bootstrapcdn.com/bootswatch/3.1.1/journal/bootstrap.min.css&quot; rel=&quot;stylesheet&quot;&gt;</span>
<span class="c">--&gt;</span>

<span class="c">&lt;!-- Potential adjustment of styles --&gt;</span>
<span class="nt">&lt;style </span><span class="na">type=</span><span class="s">&quot;text/css&quot;</span><span class="nt">&gt;</span>
<span class="c">/* Colors in the navigation sidebar */</span>
<span class="nc">.bs-docs-sidebar</span> <span class="nc">.nav</span> <span class="o">&gt;</span> <span class="nt">li</span> <span class="o">&gt;</span> <span class="nt">a</span> <span class="p">{</span>
  <span class="k">color</span><span class="o">:</span> <span class="m">#999</span><span class="p">;</span>
<span class="p">}</span>
<span class="nc">.bs-docs-sidebar</span> <span class="nc">.nav</span> <span class="o">&gt;</span> <span class="nt">li</span> <span class="o">&gt;</span> <span class="nt">a</span><span class="nd">:hover</span><span class="o">,</span>
<span class="nc">.bs-docs-sidebar</span> <span class="nc">.nav</span> <span class="o">&gt;</span> <span class="nt">li</span> <span class="o">&gt;</span> <span class="nt">a</span><span class="nd">:focus</span> <span class="p">{</span>
  <span class="k">color</span><span class="o">:</span> <span class="m">#999</span><span class="p">;</span>
<span class="p">}</span>
<span class="nc">.bs-docs-sidebar</span> <span class="nc">.nav</span> <span class="o">&gt;</span> <span class="nc">.active</span> <span class="o">&gt;</span> <span class="nt">a</span><span class="o">,</span>
<span class="nc">.bs-docs-sidebar</span> <span class="nc">.nav</span> <span class="o">&gt;</span> <span class="nc">.active</span><span class="nd">:hover</span> <span class="o">&gt;</span> <span class="nt">a</span><span class="o">,</span>
<span class="nc">.bs-docs-sidebar</span> <span class="nc">.nav</span> <span class="o">&gt;</span> <span class="nc">.active</span><span class="nd">:focus</span> <span class="o">&gt;</span> <span class="nt">a</span> <span class="p">{</span>
  <span class="k">color</span><span class="o">:</span> <span class="m">#563d7c</span><span class="p">;</span>
<span class="p">}</span>
<span class="nt">&lt;/style&gt;</span>

<span class="nt">&lt;/head&gt;</span>

<span class="nt">&lt;body&gt;</span>
<span class="nt">&lt;a</span> <span class="na">class=</span><span class="s">&quot;sr-only sr-only-focusable&quot;</span> <span class="na">href=</span><span class="s">&quot;#content&quot;</span><span class="nt">&gt;</span>Skip to main content<span class="nt">&lt;/a&gt;</span>

<span class="c">&lt;!-- Docs master nav --&gt;</span>
<span class="nt">&lt;header</span> <span class="na">class=</span><span class="s">&quot;navbar navbar-static-top bs-docs-nav&quot;</span> <span class="na">id=</span><span class="s">&quot;top&quot;</span> <span class="na">role=</span><span class="s">&quot;banner&quot;</span><span class="nt">&gt;</span>
<span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">&quot;container&quot;</span><span class="nt">&gt;</span>
  <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">&quot;navbar-header&quot;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;button</span> <span class="na">class=</span><span class="s">&quot;navbar-toggle&quot;</span> <span class="na">type=</span><span class="s">&quot;button&quot;</span> <span class="na">data-toggle=</span><span class="s">&quot;collapse&quot;</span> <span class="na">data-target=</span><span class="s">&quot;.bs-navbar-collapse&quot;</span><span class="nt">&gt;</span>
      <span class="nt">&lt;span</span> <span class="na">class=</span><span class="s">&quot;sr-only&quot;</span><span class="nt">&gt;</span>Toggle navigation<span class="nt">&lt;/span&gt;</span>
      <span class="nt">&lt;span</span> <span class="na">class=</span><span class="s">&quot;icon-bar&quot;</span><span class="nt">&gt;&lt;/span&gt;</span>
      <span class="nt">&lt;span</span> <span class="na">class=</span><span class="s">&quot;icon-bar&quot;</span><span class="nt">&gt;&lt;/span&gt;</span>
      <span class="nt">&lt;span</span> <span class="na">class=</span><span class="s">&quot;icon-bar&quot;</span><span class="nt">&gt;&lt;/span&gt;</span>
    <span class="nt">&lt;/button&gt;</span>
    <span class="nt">&lt;a</span> <span class="na">href=</span><span class="s">&quot;http://some.website.net/some/path&quot;</span> <span class="na">class=</span><span class="s">&quot;navbar-brand&quot;</span><span class="nt">&gt;</span>Experiments with Schemes for Exponential Decay<span class="nt">&lt;/a&gt;</span>
  <span class="nt">&lt;/div&gt;</span>
  <span class="nt">&lt;nav</span> <span class="na">class=</span><span class="s">&quot;collapse navbar-collapse bs-navbar-collapse&quot;</span> <span class="na">role=</span><span class="s">&quot;navigation&quot;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;ul</span> <span class="na">class=</span><span class="s">&quot;nav navbar-nav navbar-right&quot;</span><span class="nt">&gt;</span>
      <span class="nt">&lt;li&gt;&lt;a</span> <span class="na">href=</span><span class="s">&quot;http://wikipedia.org&quot;</span> <span class="na">target=</span><span class="s">&quot;_blank&quot;</span><span class="nt">&gt;</span>Wikipedia<span class="nt">&lt;/a&gt;&lt;/li&gt;</span>
      <span class="nt">&lt;li&gt;&lt;a</span> <span class="na">href=</span><span class="s">&quot;http://wolframalpha.com&quot;</span> <span class="na">target=</span><span class="s">&quot;_blank&quot;</span><span class="nt">&gt;</span>WolframAlpha<span class="nt">&lt;/a&gt;&lt;/li&gt;</span>
    <span class="nt">&lt;/ul&gt;</span>
  <span class="nt">&lt;/nav&gt;</span>
<span class="nt">&lt;/div&gt;</span>
<span class="nt">&lt;/header&gt;</span>


<span class="c">&lt;!-- Docs page layout --&gt;</span>

<span class="c">&lt;!-- A purple header field with the title is optional, but it requires</span>
<span class="c">the docs.min.css style, which makes orange math...</span>
<span class="c">&lt;div class=&quot;bs-docs-header&quot; id=&quot;content&quot;&gt;</span>
<span class="c"> &lt;div class=&quot;container&quot;&gt;</span>
<span class="c">  &lt;h1&gt;Experiments with Schemes for Exponential Decay&lt;/h1&gt;</span>

<span class="c">&lt;p&gt;Investigation of numerical artifacts&lt;/p&gt;</span>
<span class="c"> &lt;/div&gt;</span>
<span class="c">&lt;/div&gt;</span>
<span class="c">--&gt;</span>

<span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">&quot;container bs-docs-container&quot;</span><span class="nt">&gt;</span>

 <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">&quot;row&quot;</span><span class="nt">&gt;</span>

  <span class="c">&lt;!-- main content --&gt;</span>
  <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">&quot;col-md-9&quot;</span> <span class="na">role=</span><span class="s">&quot;main&quot;</span><span class="nt">&gt;</span>

<span class="c">&lt;!-- tocinfo</span>
<span class="c">{&#39;highest level&#39;: 1,</span>
<span class="c"> &#39;sections&#39;: [(&#39;Mathematical problem&#39;, 1, &#39;math:problem&#39;, &#39;math:problem&#39;),</span>
<span class="c">              (&#39;Numerical solution method&#39;,</span>
<span class="c">               1,</span>
<span class="c">               &#39;numerical:problem&#39;,</span>
<span class="c">               &#39;numerical:problem&#39;),</span>
<span class="c">              (&#39;Implementation&#39;, 1, None, &#39;___sec2&#39;),</span>
<span class="c">              (&#39;Numerical experiments&#39;, 1, None, &#39;___sec3&#39;),</span>
<span class="c">              (&#39;The Backward Euler method&#39;, 2, None, &#39;___sec4&#39;),</span>
<span class="c">              (&#39;The Crank-Nicolson method&#39;, 2, None, &#39;___sec5&#39;),</span>
<span class="c">              (&#39;The Forward Euler method&#39;, 2, None, &#39;___sec6&#39;),</span>
<span class="c">              (&#39;Error vs $\\Delta t$&#39;, 2, None, &#39;___sec7&#39;),</span>
<span class="c">              (&#39;Bibliography&#39;, 1, None, &#39;___sec8&#39;)]}</span>
<span class="c">end of tocinfo --&gt;</span>





<span class="nt">&lt;script </span><span class="na">type=</span><span class="s">&quot;text/x-mathjax-config&quot;</span><span class="nt">&gt;</span>
<span class="nx">MathJax</span><span class="p">.</span><span class="nx">Hub</span><span class="p">.</span><span class="nx">Config</span><span class="p">({</span>
  <span class="nx">TeX</span><span class="o">:</span> <span class="p">{</span>
     <span class="nx">equationNumbers</span><span class="o">:</span> <span class="p">{</span>  <span class="nx">autoNumber</span><span class="o">:</span> <span class="s2">&quot;AMS&quot;</span>  <span class="p">},</span>
     <span class="nx">extensions</span><span class="o">:</span> <span class="p">[</span><span class="s2">&quot;AMSmath.js&quot;</span><span class="p">,</span> <span class="s2">&quot;AMSsymbols.js&quot;</span><span class="p">,</span> <span class="s2">&quot;autobold.js&quot;</span><span class="p">,</span> <span class="s2">&quot;color.js&quot;</span><span class="p">]</span>
  <span class="p">}</span>
<span class="p">});</span>
<span class="nt">&lt;/script&gt;</span>
<span class="nt">&lt;script </span><span class="na">type=</span><span class="s">&quot;text/javascript&quot;</span>
 <span class="na">src=</span><span class="s">&quot;http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML&quot;</span><span class="nt">&gt;</span>
<span class="nt">&lt;/script&gt;</span>



<span class="c">&lt;!-- ------------------- main content ---------------------- --&gt;</span>

<span class="nt">&lt;h1&gt;</span>Experiments with Schemes for Exponential Decay<span class="nt">&lt;/h1&gt;</span>

<span class="c">&lt;!-- AUTHOR: Hans Petter Langtangen Email:hpl@simula.no at Center for Biomedical Computing, Simula Research Laboratory &amp;amp; Department of Informatics, University of Oslo. --&gt;</span>
<span class="nt">&lt;p&gt;</span>

<span class="nt">&lt;br&gt;</span>
<span class="nt">&lt;p&gt;</span>
<span class="nt">&lt;b&gt;</span>Summary.<span class="nt">&lt;/b&gt;</span> This report investigates the accuracy of three finite difference
schemes for the ordinary differential equation \( u&#39;=-au \) with the
aid of numerical experiments. Numerical artifacts are in particular
demonstrated.

<span class="nt">&lt;p&gt;</span>
<span class="c">&lt;!-- </span>
<span class="c">TOC: on --&gt;</span>

<span class="nt">&lt;p&gt;</span>
<span class="c">&lt;!-- !split --&gt;</span>

<span class="nt">&lt;h1</span> <span class="na">id=</span><span class="s">&quot;math:problem&quot;</span><span class="nt">&gt;</span>Mathematical problem<span class="nt">&lt;/h1&gt;</span>

<span class="nt">&lt;p&gt;</span>
We address the initial-value problem

$$
\begin{align}
u&#39;(t) <span class="err">&amp;</span>= -au(t), \quad t \in (0,T], \label{ode}\\
u(0)  <span class="err">&amp;</span>= I,                         \label{initial:value}
\end{align}
$$

where \( a \), \( I \), and \( T \) are prescribed parameters, and \( u(t) \) is
the unknown function to be estimated. This mathematical model
is relevant for physical phenomena featuring exponential decay
in time, e.g., vertical pressure variation in the atmosphere,
cooling of an object, and radioactive decay.

<span class="nt">&lt;h1</span> <span class="na">id=</span><span class="s">&quot;numerical:problem&quot;</span><span class="nt">&gt;</span>Numerical solution method<span class="nt">&lt;/h1&gt;</span>

<span class="nt">&lt;p&gt;</span>
We introduce a mesh in time with points \( 0 = t_0 <span class="nt">&lt; t_1</span> <span class="err">\</span><span class="na">cdots</span> <span class="err">&lt;</span> <span class="na">t_</span><span class="err">{</span><span class="na">N_t</span><span class="err">}=</span><span class="na">T</span> <span class="err">\).</span>
<span class="na">For</span> <span class="na">simplicity</span><span class="err">,</span> <span class="na">we</span> <span class="na">assume</span> <span class="na">constant</span> <span class="na">spacing</span> <span class="err">\(</span> <span class="err">\</span><span class="na">Delta</span> <span class="na">t</span> <span class="err">\)</span> <span class="na">between</span> <span class="na">the</span>
<span class="na">mesh</span> <span class="na">points:</span> <span class="err">\(</span> <span class="err">\</span><span class="na">Delta</span> <span class="na">t =</span> <span class="s">t_{n}-t_{n-1}</span> <span class="err">\),</span> <span class="err">\(</span> <span class="na">n=</span><span class="s">1,\ldots,N_t</span> <span class="err">\).</span> <span class="na">Let</span>
<span class="err">\(</span> <span class="na">u</span><span class="err">^</span><span class="na">n</span> <span class="err">\)</span> <span class="na">be</span> <span class="na">the</span> <span class="na">numerical</span> <span class="na">approximation</span> <span class="na">to</span> <span class="na">the</span> <span class="na">exact</span> <span class="na">solution</span> <span class="na">at</span> <span class="err">\(</span> <span class="na">t_n</span> <span class="err">\).</span>

<span class="err">&lt;</span><span class="na">p</span><span class="nt">&gt;</span>
The \( \theta \)-rule <span class="nt">&lt;a</span> <span class="na">href=</span><span class="s">&quot;#Iserles_2009&quot;</span><span class="nt">&gt;</span>[1]<span class="nt">&lt;/a&gt;</span>
is used to solve \eqref{ode} numerically:

$$
u^{n+1} = \frac{1 - (1-\theta) a\Delta t}{1 + \theta a\Delta t}u^n,
$$

for \( n=0,1,\ldots,N_t-1 \). This scheme corresponds to

<span class="nt">&lt;ul&gt;</span>
  <span class="nt">&lt;li&gt;</span> The <span class="nt">&lt;a</span> <span class="na">href=</span><span class="s">&quot;http://en.wikipedia.org/wiki/Forward_Euler_method&quot;</span> <span class="na">target=</span><span class="s">&quot;_self&quot;</span><span class="nt">&gt;</span>Forward Euler<span class="nt">&lt;/a&gt;</span>
    scheme when \( \theta=0 \)<span class="nt">&lt;/li&gt;</span>
  <span class="nt">&lt;li&gt;</span> The <span class="nt">&lt;a</span> <span class="na">href=</span><span class="s">&quot;http://en.wikipedia.org/wiki/Backward_Euler_method&quot;</span> <span class="na">target=</span><span class="s">&quot;_self&quot;</span><span class="nt">&gt;</span>Backward Euler<span class="nt">&lt;/a&gt;</span>
    scheme when \( \theta=1 \)<span class="nt">&lt;/li&gt;</span>
  <span class="nt">&lt;li&gt;</span> The <span class="nt">&lt;a</span> <span class="na">href=</span><span class="s">&quot;http://en.wikipedia.org/wiki/Crank-Nicolson&quot;</span> <span class="na">target=</span><span class="s">&quot;_self&quot;</span><span class="nt">&gt;</span>Crank-Nicolson<span class="nt">&lt;/a&gt;</span>
    scheme when \( \theta=1/2 \)<span class="nt">&lt;/li&gt;</span>
<span class="nt">&lt;/ul&gt;</span>

<span class="nt">&lt;h1</span> <span class="na">id=</span><span class="s">&quot;___sec2&quot;</span><span class="nt">&gt;</span>Implementation <span class="nt">&lt;/h1&gt;</span>

<span class="nt">&lt;p&gt;</span>
The numerical method is implemented in a Python function
<span class="nt">&lt;a</span> <span class="na">href=</span><span class="s">&quot;#Langtangen_2014&quot;</span><span class="nt">&gt;</span>[2]<span class="nt">&lt;/a&gt;</span> <span class="nt">&lt;code&gt;</span>solver<span class="nt">&lt;/code&gt;</span> (found in the <span class="nt">&lt;a</span> <span class="na">href=</span><span class="s">&quot;https://github.com/hplgit/INF5620/blob/gh-pages/src/decay/experiments/dc_mod.py&quot;</span> <span class="na">target=</span><span class="s">&quot;_self&quot;</span><span class="nt">&gt;&lt;tt&gt;</span>model<span class="nt">&lt;/tt&gt;&lt;/a&gt;</span> module):

<span class="nt">&lt;p&gt;</span>
<span class="c">&lt;!-- begin verbatim block  pycod--&gt;</span>
<span class="nt">&lt;pre&gt;&lt;code&gt;</span>def solver(I, a, T, dt, theta):
    <span class="ni">&amp;quot;&amp;quot;&amp;quot;</span>Solve u&#39;=-a*u, u(0)=I, for t in (0,T] with steps of dt.<span class="ni">&amp;quot;&amp;quot;&amp;quot;</span>
    dt = float(dt)            # avoid integer division
    Nt = int(round(T/dt))     # no of time intervals
    T = Nt*dt                 # adjust T to fit time step dt
    u = zeros(Nt+1)           # array of u[n] values
    t = linspace(0, T, Nt+1)  # time mesh

    u[0] = I                  # assign initial condition
    for n in range(0, Nt):    # n=0,1,...,Nt-1
        u[n+1] = (1 - (1-theta)*a*dt)/(1 + theta*dt*a)*u[n]
    return u, t
<span class="nt">&lt;/code&gt;&lt;/pre&gt;</span>
<span class="c">&lt;!-- end verbatim block --&gt;</span>

<span class="nt">&lt;h1</span> <span class="na">id=</span><span class="s">&quot;___sec3&quot;</span><span class="nt">&gt;</span>Numerical experiments <span class="nt">&lt;/h1&gt;</span>

<span class="nt">&lt;p&gt;</span>
We define a set of numerical experiments where \( I \), \( a \), and \( T \) are
fixed, while \( \Delta t \) and \( \theta \) are varied.
In particular, \( I=1 \), \( a=2 \), \( \Delta t = 1.25, 0.75, 0.5, 0.1 \).

<span class="nt">&lt;h2</span> <span class="na">id=</span><span class="s">&quot;___sec4&quot;</span><span class="nt">&gt;</span>The Backward Euler method <span class="nt">&lt;/h2&gt;</span>

<span class="nt">&lt;p&gt;</span>
<span class="nt">&lt;center&gt;&lt;p&gt;&lt;img</span> <span class="na">src=</span><span class="s">&quot;BE.png&quot;</span> <span class="na">align=</span><span class="s">&quot;bottom&quot;</span> <span class="na">width=</span><span class="s">800</span><span class="nt">&gt;&lt;/p&gt;&lt;/center&gt;</span>

<span class="nt">&lt;h2</span> <span class="na">id=</span><span class="s">&quot;___sec5&quot;</span><span class="nt">&gt;</span>The Crank-Nicolson method <span class="nt">&lt;/h2&gt;</span>

<span class="nt">&lt;p&gt;</span>
<span class="nt">&lt;center&gt;&lt;p&gt;&lt;img</span> <span class="na">src=</span><span class="s">&quot;CN.png&quot;</span> <span class="na">align=</span><span class="s">&quot;bottom&quot;</span> <span class="na">width=</span><span class="s">800</span><span class="nt">&gt;&lt;/p&gt;&lt;/center&gt;</span>

<span class="nt">&lt;h2</span> <span class="na">id=</span><span class="s">&quot;___sec6&quot;</span><span class="nt">&gt;</span>The Forward Euler method <span class="nt">&lt;/h2&gt;</span>

<span class="nt">&lt;p&gt;</span>
<span class="nt">&lt;center&gt;&lt;p&gt;&lt;img</span> <span class="na">src=</span><span class="s">&quot;FE.png&quot;</span> <span class="na">align=</span><span class="s">&quot;bottom&quot;</span> <span class="na">width=</span><span class="s">800</span><span class="nt">&gt;&lt;/p&gt;&lt;/center&gt;</span>

<span class="nt">&lt;h2</span> <span class="na">id=</span><span class="s">&quot;___sec7&quot;</span><span class="nt">&gt;</span>Error vs \( \Delta t \) <span class="nt">&lt;/h2&gt;</span>

<span class="nt">&lt;p&gt;</span>
How \( E \) varies with \( \Delta t \) for \( \theta=0,0.5,1 \)
is shown in Figure <span class="nt">&lt;a</span> <span class="na">href=</span><span class="s">&quot;#fig:error&quot;</span><span class="nt">&gt;</span>1<span class="nt">&lt;/a&gt;</span>.

<span class="nt">&lt;p&gt;</span>
<span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">&quot;alert alert-block alert-danger alert-text-normal&quot;</span><span class="nt">&gt;&lt;b&gt;</span>Observe:<span class="nt">&lt;/b&gt;</span>
The data points for the three largest \( \Delta t \) values in the
Forward Euler method are not relevant as the solution behaves
non-physically.
<span class="nt">&lt;/div&gt;</span>


<span class="nt">&lt;p&gt;</span>
<span class="nt">&lt;center&gt;</span> <span class="c">&lt;!-- figure --&gt;</span>
<span class="nt">&lt;hr</span> <span class="na">class=</span><span class="s">&quot;figure&quot;</span><span class="nt">&gt;</span>
<span class="nt">&lt;center&gt;&lt;p</span> <span class="na">class=</span><span class="s">&quot;caption&quot;</span><span class="nt">&gt;</span>Figure 1:  Variation of the error with the time step. <span class="nt">&lt;div</span> <span class="na">id=</span><span class="s">&quot;fig:error&quot;</span><span class="nt">&gt;&lt;/div&gt;</span> <span class="nt">&lt;/p&gt;&lt;/center&gt;</span>
<span class="nt">&lt;p&gt;&lt;img</span> <span class="na">src=</span><span class="s">&quot;error.png&quot;</span> <span class="na">align=</span><span class="s">&quot;bottom&quot;</span> <span class="na">width=</span><span class="s">400</span><span class="nt">&gt;&lt;/p&gt;</span>
<span class="nt">&lt;/center&gt;</span>

<span class="nt">&lt;p&gt;</span>
The numbers corresponding to the figure above are given in the table below.

<span class="nt">&lt;p&gt;</span>

<span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">&quot;row&quot;</span><span class="nt">&gt;</span>
  <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">&quot;col-xs-6&quot;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;table</span> <span class="na">class=</span><span class="s">&quot;table table-striped table-hover table-condensed&quot;</span><span class="nt">&gt;</span>
<span class="nt">&lt;thead&gt;</span>
<span class="nt">&lt;tr&gt;&lt;td</span> <span class="na">align=</span><span class="s">&quot;center&quot;</span><span class="nt">&gt;</span>\( \Delta t \)<span class="nt">&lt;/td&gt;</span> <span class="nt">&lt;td</span> <span class="na">align=</span><span class="s">&quot;center&quot;</span><span class="nt">&gt;</span>\( \theta=0 \)<span class="nt">&lt;/td&gt;</span> <span class="nt">&lt;td</span> <span class="na">align=</span><span class="s">&quot;center&quot;</span><span class="nt">&gt;</span>\( \theta=0.5 \)<span class="nt">&lt;/td&gt;</span> <span class="nt">&lt;td</span> <span class="na">align=</span><span class="s">&quot;center&quot;</span><span class="nt">&gt;</span>\( \theta=1 \)<span class="nt">&lt;/td&gt;</span> <span class="nt">&lt;/tr&gt;</span>
<span class="nt">&lt;/thead&gt;</span>
<span class="nt">&lt;tbody&gt;</span>
<span class="nt">&lt;tr&gt;&lt;td</span> <span class="na">align=</span><span class="s">&quot;right&quot;</span><span class="nt">&gt;</span>   1.25              <span class="nt">&lt;/td&gt;</span> <span class="nt">&lt;td</span> <span class="na">align=</span><span class="s">&quot;right&quot;</span><span class="nt">&gt;</span>   7.4630            <span class="nt">&lt;/td&gt;</span> <span class="nt">&lt;td</span> <span class="na">align=</span><span class="s">&quot;right&quot;</span><span class="nt">&gt;</span>   0.2161              <span class="nt">&lt;/td&gt;</span> <span class="nt">&lt;td</span> <span class="na">align=</span><span class="s">&quot;right&quot;</span><span class="nt">&gt;</span>   0.2440            <span class="nt">&lt;/td&gt;</span> <span class="nt">&lt;/tr&gt;</span>
<span class="nt">&lt;tr&gt;&lt;td</span> <span class="na">align=</span><span class="s">&quot;right&quot;</span><span class="nt">&gt;</span>   0.75              <span class="nt">&lt;/td&gt;</span> <span class="nt">&lt;td</span> <span class="na">align=</span><span class="s">&quot;right&quot;</span><span class="nt">&gt;</span>   0.6632            <span class="nt">&lt;/td&gt;</span> <span class="nt">&lt;td</span> <span class="na">align=</span><span class="s">&quot;right&quot;</span><span class="nt">&gt;</span>   0.0744              <span class="nt">&lt;/td&gt;</span> <span class="nt">&lt;td</span> <span class="na">align=</span><span class="s">&quot;right&quot;</span><span class="nt">&gt;</span>   0.1875            <span class="nt">&lt;/td&gt;</span> <span class="nt">&lt;/tr&gt;</span>
<span class="nt">&lt;tr&gt;&lt;td</span> <span class="na">align=</span><span class="s">&quot;right&quot;</span><span class="nt">&gt;</span>   0.50              <span class="nt">&lt;/td&gt;</span> <span class="nt">&lt;td</span> <span class="na">align=</span><span class="s">&quot;right&quot;</span><span class="nt">&gt;</span>   0.2797            <span class="nt">&lt;/td&gt;</span> <span class="nt">&lt;td</span> <span class="na">align=</span><span class="s">&quot;right&quot;</span><span class="nt">&gt;</span>   0.0315              <span class="nt">&lt;/td&gt;</span> <span class="nt">&lt;td</span> <span class="na">align=</span><span class="s">&quot;right&quot;</span><span class="nt">&gt;</span>   0.1397            <span class="nt">&lt;/td&gt;</span> <span class="nt">&lt;/tr&gt;</span>
<span class="nt">&lt;tr&gt;&lt;td</span> <span class="na">align=</span><span class="s">&quot;right&quot;</span><span class="nt">&gt;</span>   0.10              <span class="nt">&lt;/td&gt;</span> <span class="nt">&lt;td</span> <span class="na">align=</span><span class="s">&quot;right&quot;</span><span class="nt">&gt;</span>   0.0377            <span class="nt">&lt;/td&gt;</span> <span class="nt">&lt;td</span> <span class="na">align=</span><span class="s">&quot;right&quot;</span><span class="nt">&gt;</span>   0.0012              <span class="nt">&lt;/td&gt;</span> <span class="nt">&lt;td</span> <span class="na">align=</span><span class="s">&quot;right&quot;</span><span class="nt">&gt;</span>   0.0335            <span class="nt">&lt;/td&gt;</span> <span class="nt">&lt;/tr&gt;</span>
<span class="nt">&lt;/tbody&gt;</span>
    <span class="nt">&lt;/table&gt;</span>
  <span class="nt">&lt;/div&gt;</span>
<span class="nt">&lt;/div&gt;</span> <span class="c">&lt;!-- col-xs-6 --&gt;</span>
<span class="nt">&lt;p&gt;</span>
<span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">&quot;alert alert-block alert-warning alert-text-normal&quot;</span><span class="nt">&gt;&lt;b&gt;</span>Summary.<span class="nt">&lt;/b&gt;</span>

<span class="nt">&lt;ol&gt;</span>
<span class="nt">&lt;li&gt;</span> \( \theta =1 \): \( E\sim \Delta t \) (first-order convergence).<span class="nt">&lt;/li&gt;</span>
<span class="nt">&lt;li&gt;</span> \( \theta =0.5 \): \( E\sim \Delta t^2 \) (second-order convergence).<span class="nt">&lt;/li&gt;</span>
<span class="nt">&lt;li&gt;</span> \( \theta =1 \) is always stable and gives qualitatively corrects results.<span class="nt">&lt;/li&gt;</span>
<span class="nt">&lt;li&gt;</span> \( \theta =0.5 \) never blows up, but may give oscillating solutions
   if \( \Delta t \) is not sufficiently small.<span class="nt">&lt;/li&gt;</span>
<span class="nt">&lt;li&gt;</span> \( \theta =0 \) suffers from fast-growing solution if \( \Delta t \) is
   not small enough, but even below this limit one can have oscillating
   solutions (unless \( \Delta t \) is sufficiently small).<span class="nt">&lt;/li&gt;</span>
<span class="nt">&lt;/ol&gt;</span>
<span class="nt">&lt;/div&gt;</span>


<span class="nt">&lt;h1</span> <span class="na">id=</span><span class="s">&quot;___sec8&quot;</span><span class="nt">&gt;</span>Bibliography <span class="nt">&lt;/h1&gt;</span>

<span class="nt">&lt;p&gt;</span>
<span class="c">&lt;!-- begin bibliography --&gt;</span>

<span class="nt">&lt;ol&gt;</span>
 <span class="nt">&lt;li&gt;</span> <span class="nt">&lt;div</span> <span class="na">id=</span><span class="s">&quot;Iserles_2009&quot;</span><span class="nt">&gt;&lt;/div&gt;</span> <span class="nt">&lt;b&gt;</span>A. Iserles<span class="nt">&lt;/b&gt;</span>. 
    <span class="nt">&lt;em&gt;</span>A First Course in the Numerical Analysis of Differential Equations<span class="nt">&lt;/em&gt;</span>,
    second edition,
    Cambridge University Press,
    2009.<span class="nt">&lt;/li&gt;</span>
 <span class="nt">&lt;li&gt;</span> <span class="nt">&lt;div</span> <span class="na">id=</span><span class="s">&quot;Langtangen_2014&quot;</span><span class="nt">&gt;&lt;/div&gt;</span> <span class="nt">&lt;b&gt;</span>H. P. Langtangen<span class="nt">&lt;/b&gt;</span>. 
    <span class="nt">&lt;em&gt;</span>A Primer on Scientific Programming With Python<span class="nt">&lt;/em&gt;</span>,
    fourth edition,
    Springer,
    2014.<span class="nt">&lt;/li&gt;</span>
<span class="nt">&lt;/ol&gt;</span>

<span class="c">&lt;!-- end bibliography --&gt;</span>

<span class="c">&lt;!-- ------------------- end of main content --------------- --&gt;</span>

  <span class="nt">&lt;/div&gt;</span>

  <span class="c">&lt;!-- sidebar with navigation --&gt;</span>
  <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">&quot;col-md-3&quot;</span><span class="nt">&gt;</span>
   <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">&quot;bs-docs-sidebar hidden-print hidden-xs hidden-sm&quot;</span> <span class="na">role=</span><span class="s">&quot;complementary&quot;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;ul</span> <span class="na">class=</span><span class="s">&quot;nav bs-docs-sidenav&quot;</span><span class="nt">&gt;</span>
     <span class="c">&lt;!-- navigation toc: --&gt;</span> <span class="nt">&lt;li&gt;&lt;a</span> <span class="na">href=</span><span class="s">&quot;#math:problem&quot;</span> <span class="na">style=</span><span class="s">&quot;font-size: 80%;&quot;</span><span class="nt">&gt;&lt;b&gt;</span>Mathematical problem<span class="nt">&lt;/b&gt;&lt;/a&gt;&lt;/li&gt;</span>
     <span class="c">&lt;!-- navigation toc: --&gt;</span> <span class="nt">&lt;li&gt;&lt;a</span> <span class="na">href=</span><span class="s">&quot;#numerical:problem&quot;</span> <span class="na">style=</span><span class="s">&quot;font-size: 80%;&quot;</span><span class="nt">&gt;&lt;b&gt;</span>Numerical solution method<span class="nt">&lt;/b&gt;&lt;/a&gt;&lt;/li&gt;</span>
     <span class="c">&lt;!-- navigation toc: --&gt;</span> <span class="nt">&lt;li&gt;&lt;a</span> <span class="na">href=</span><span class="s">&quot;#___sec2&quot;</span> <span class="na">style=</span><span class="s">&quot;font-size: 80%;&quot;</span><span class="nt">&gt;&lt;b&gt;</span>Implementation<span class="nt">&lt;/b&gt;&lt;/a&gt;&lt;/li&gt;</span>
     <span class="c">&lt;!-- navigation toc: --&gt;</span> <span class="nt">&lt;li&gt;&lt;a</span> <span class="na">href=</span><span class="s">&quot;#___sec3&quot;</span> <span class="na">style=</span><span class="s">&quot;font-size: 80%;&quot;</span><span class="nt">&gt;&lt;b&gt;</span>Numerical experiments<span class="nt">&lt;/b&gt;&lt;/a&gt;&lt;/li&gt;</span>
     <span class="c">&lt;!-- navigation toc: --&gt;</span> <span class="nt">&lt;li&gt;&lt;a</span> <span class="na">href=</span><span class="s">&quot;#___sec4&quot;</span> <span class="na">style=</span><span class="s">&quot;font-size: 80%;&quot;</span><span class="nt">&gt;</span><span class="ni">&amp;nbsp;&amp;nbsp;&amp;nbsp;</span>The Backward Euler method<span class="nt">&lt;/a&gt;&lt;/li&gt;</span>
     <span class="c">&lt;!-- navigation toc: --&gt;</span> <span class="nt">&lt;li&gt;&lt;a</span> <span class="na">href=</span><span class="s">&quot;#___sec5&quot;</span> <span class="na">style=</span><span class="s">&quot;font-size: 80%;&quot;</span><span class="nt">&gt;</span><span class="ni">&amp;nbsp;&amp;nbsp;&amp;nbsp;</span>The Crank-Nicolson method<span class="nt">&lt;/a&gt;&lt;/li&gt;</span>
     <span class="c">&lt;!-- navigation toc: --&gt;</span> <span class="nt">&lt;li&gt;&lt;a</span> <span class="na">href=</span><span class="s">&quot;#___sec6&quot;</span> <span class="na">style=</span><span class="s">&quot;font-size: 80%;&quot;</span><span class="nt">&gt;</span><span class="ni">&amp;nbsp;&amp;nbsp;&amp;nbsp;</span>The Forward Euler method<span class="nt">&lt;/a&gt;&lt;/li&gt;</span>
     <span class="c">&lt;!-- navigation toc: --&gt;</span> <span class="nt">&lt;li&gt;&lt;a</span> <span class="na">href=</span><span class="s">&quot;#___sec7&quot;</span> <span class="na">style=</span><span class="s">&quot;font-size: 80%;&quot;</span><span class="nt">&gt;</span><span class="ni">&amp;nbsp;&amp;nbsp;&amp;nbsp;</span>Error vs \( \Delta t \)<span class="nt">&lt;/a&gt;&lt;/li&gt;</span>
     <span class="c">&lt;!-- navigation toc: --&gt;</span> <span class="nt">&lt;li&gt;&lt;a</span> <span class="na">href=</span><span class="s">&quot;#___sec8&quot;</span> <span class="na">style=</span><span class="s">&quot;font-size: 80%;&quot;</span><span class="nt">&gt;&lt;b&gt;</span>Bibliography<span class="nt">&lt;/b&gt;&lt;/a&gt;&lt;/li&gt;</span>

    <span class="nt">&lt;/ul&gt;</span>
    <span class="nt">&lt;a</span> <span class="na">class=</span><span class="s">&quot;back-to-top&quot;</span> <span class="na">href=</span><span class="s">&quot;#top&quot;</span><span class="nt">&gt;</span>Back to top<span class="nt">&lt;/a&gt;</span>
   <span class="nt">&lt;/div&gt;</span>
  <span class="nt">&lt;/div&gt;</span>
 <span class="nt">&lt;/div&gt;</span>

 <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">&quot;row Footer&quot;</span><span class="nt">&gt;</span>
  <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">&quot;span12&quot;</span><span class="nt">&gt;</span>
   <span class="nt">&lt;center&gt;</span>
  H. P. Langtangen <span class="ni">&amp;copy;</span> 2014
   <span class="nt">&lt;/center&gt;</span>
  <span class="nt">&lt;/div&gt;</span>
 <span class="nt">&lt;/div&gt;</span>
<span class="nt">&lt;/div&gt;</span>

<span class="c">&lt;!-- JavaScript placed at the end of the document so the pages load faster --&gt;</span>
<span class="nt">&lt;script </span><span class="na">src=</span><span class="s">&quot;https://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js&quot;</span><span class="nt">&gt;&lt;/script&gt;</span>
<span class="nt">&lt;script </span><span class="na">src=</span><span class="s">&quot;http://getbootstrap.com/dist/js/bootstrap.min.js&quot;</span><span class="nt">&gt;&lt;/script&gt;</span>
<span class="c">&lt;!-- NOTE: replace rawgit.com by cdn.rawgit.com for production or</span>
<span class="c">sites with heavy traffic --&gt;</span>
<span class="nt">&lt;script </span><span class="na">src=</span><span class="s">&quot;https://rawgit.com/hplgit/doconce/master/bundled/html_styles/style_bootstrap_wtoc/js/docs.min.js&quot;</span><span class="nt">&gt;&lt;/script&gt;</span>
<span class="nt">&lt;/html&gt;</span>
</pre></div>
</body>
</html>
