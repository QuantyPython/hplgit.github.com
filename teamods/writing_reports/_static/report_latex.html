<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN"
   "http://www.w3.org/TR/html4/strict.dtd">

<html>
<head>
  <title></title>
  <meta http-equiv="content-type" content="text/html; charset=latin1">
  <style type="text/css">
td.linenos { background-color: #f0f0f0; padding-right: 10px; }
span.lineno { background-color: #f0f0f0; padding: 0 5px 0 5px; }
pre { line-height: 125%; }
body .hll { background-color: #ffffcc }
body  { background: #f8f8f8; }
body .c { color: #008800; font-style: italic } /* Comment */
body .err { border: 1px solid #FF0000 } /* Error */
body .k { color: #AA22FF; font-weight: bold } /* Keyword */
body .o { color: #666666 } /* Operator */
body .cm { color: #008800; font-style: italic } /* Comment.Multiline */
body .cp { color: #008800 } /* Comment.Preproc */
body .c1 { color: #008800; font-style: italic } /* Comment.Single */
body .cs { color: #008800; font-weight: bold } /* Comment.Special */
body .gd { color: #A00000 } /* Generic.Deleted */
body .ge { font-style: italic } /* Generic.Emph */
body .gr { color: #FF0000 } /* Generic.Error */
body .gh { color: #000080; font-weight: bold } /* Generic.Heading */
body .gi { color: #00A000 } /* Generic.Inserted */
body .go { color: #888888 } /* Generic.Output */
body .gp { color: #000080; font-weight: bold } /* Generic.Prompt */
body .gs { font-weight: bold } /* Generic.Strong */
body .gu { color: #800080; font-weight: bold } /* Generic.Subheading */
body .gt { color: #0044DD } /* Generic.Traceback */
body .kc { color: #AA22FF; font-weight: bold } /* Keyword.Constant */
body .kd { color: #AA22FF; font-weight: bold } /* Keyword.Declaration */
body .kn { color: #AA22FF; font-weight: bold } /* Keyword.Namespace */
body .kp { color: #AA22FF } /* Keyword.Pseudo */
body .kr { color: #AA22FF; font-weight: bold } /* Keyword.Reserved */
body .kt { color: #00BB00; font-weight: bold } /* Keyword.Type */
body .m { color: #666666 } /* Literal.Number */
body .s { color: #BB4444 } /* Literal.String */
body .na { color: #BB4444 } /* Name.Attribute */
body .nb { color: #AA22FF } /* Name.Builtin */
body .nc { color: #0000FF } /* Name.Class */
body .no { color: #880000 } /* Name.Constant */
body .nd { color: #AA22FF } /* Name.Decorator */
body .ni { color: #999999; font-weight: bold } /* Name.Entity */
body .ne { color: #D2413A; font-weight: bold } /* Name.Exception */
body .nf { color: #00A000 } /* Name.Function */
body .nl { color: #A0A000 } /* Name.Label */
body .nn { color: #0000FF; font-weight: bold } /* Name.Namespace */
body .nt { color: #008000; font-weight: bold } /* Name.Tag */
body .nv { color: #B8860B } /* Name.Variable */
body .ow { color: #AA22FF; font-weight: bold } /* Operator.Word */
body .w { color: #bbbbbb } /* Text.Whitespace */
body .mf { color: #666666 } /* Literal.Number.Float */
body .mh { color: #666666 } /* Literal.Number.Hex */
body .mi { color: #666666 } /* Literal.Number.Integer */
body .mo { color: #666666 } /* Literal.Number.Oct */
body .sb { color: #BB4444 } /* Literal.String.Backtick */
body .sc { color: #BB4444 } /* Literal.String.Char */
body .sd { color: #BB4444; font-style: italic } /* Literal.String.Doc */
body .s2 { color: #BB4444 } /* Literal.String.Double */
body .se { color: #BB6622; font-weight: bold } /* Literal.String.Escape */
body .sh { color: #BB4444 } /* Literal.String.Heredoc */
body .si { color: #BB6688; font-weight: bold } /* Literal.String.Interpol */
body .sx { color: #008000 } /* Literal.String.Other */
body .sr { color: #BB6688 } /* Literal.String.Regex */
body .s1 { color: #BB4444 } /* Literal.String.Single */
body .ss { color: #B8860B } /* Literal.String.Symbol */
body .bp { color: #AA22FF } /* Name.Builtin.Pseudo */
body .vc { color: #B8860B } /* Name.Variable.Class */
body .vg { color: #B8860B } /* Name.Variable.Global */
body .vi { color: #B8860B } /* Name.Variable.Instance */
body .il { color: #666666 } /* Literal.Number.Integer.Long */

  </style>
</head>
<body>
<h2></h2>

<div class="highlight"><pre><span class="k">\documentclass</span><span class="na">[twoside]</span><span class="nb">{</span>article<span class="nb">}</span>
<span class="k">\usepackage</span><span class="nb">{</span>relsize,epsfig,makeidx,amsmath,amsfonts<span class="nb">}</span>
<span class="k">\usepackage</span><span class="na">[latin1]</span><span class="nb">{</span>inputenc<span class="nb">}</span>
<span class="c">% Hyperlinks in PDF:</span>
<span class="k">\usepackage</span>[colorlinks=true,linkcolor=black,citecolor=black,
    filecolor=black,urlcolor=black,pdfmenubar=true,pdftoolbar=true,
    urlcolor=black,bookmarksdepth=3]<span class="nb">{</span>hyperref<span class="nb">}</span>

<span class="k">\makeindex</span>

<span class="k">\begin</span><span class="nb">{</span>document<span class="nb">}</span>
<span class="k">\title</span><span class="nb">{</span>Experiments with Schemes for Exponential Decay<span class="nb">}</span>
<span class="k">\author</span><span class="nb">{</span>Hans Petter Langtangen<span class="k">\footnote</span><span class="nb">{</span>
Center for Biomedical Computing, Simula Research Laboratory, and
Department of Informatics, University of Oslo.<span class="nb">}}</span>
<span class="k">\date</span><span class="nb">{</span><span class="k">\today</span><span class="nb">}</span>

<span class="k">\begin</span><span class="nb">{</span>abstract<span class="nb">}</span>
This report investigates the accuracy of three finite difference
schemes for the ordinary differential equation <span class="s">$</span><span class="nb">u&#39;</span><span class="o">=-</span><span class="nb">au</span><span class="s">$</span> with the
aid of numerical experiments. Numerical artifacts are in particular
demonstrated.
<span class="k">\end</span><span class="nb">{</span>abstract<span class="nb">}</span>

<span class="k">\tableofcontents</span>

<span class="k">\section</span><span class="nb">{</span>Mathematical problem<span class="nb">}</span>
<span class="k">\label</span><span class="nb">{</span>math:problem<span class="nb">}</span>
<span class="k">\index</span><span class="nb">{</span>model problem<span class="nb">}</span><span class="k">\index</span><span class="nb">{</span>exponential decay<span class="nb">}</span>

We address the initial-value problem

<span class="k">\begin</span><span class="nb">{</span>align<span class="nb">}</span>
u&#39;(t) <span class="nb">&amp;</span>= -au(t), <span class="k">\quad</span> t <span class="k">\in</span> (0,T], <span class="k">\label</span><span class="nb">{</span>ode<span class="nb">}</span><span class="k">\\</span>
u(0)  <span class="nb">&amp;</span>= I,                         <span class="k">\label</span><span class="nb">{</span>initial:value<span class="nb">}</span>
<span class="k">\end</span><span class="nb">{</span>align<span class="nb">}</span>
where <span class="s">$</span><span class="nb">a</span><span class="s">$</span>, <span class="s">$</span><span class="nb">I</span><span class="s">$</span>, and <span class="s">$</span><span class="nb">T</span><span class="s">$</span> are prescribed parameters, and <span class="s">$</span><span class="nb">u</span><span class="o">(</span><span class="nb">t</span><span class="o">)</span><span class="s">$</span> is
the unknown function to be estimated. This mathematical model
is relevant for physical phenomena featuring exponential decay
in time, e.g., vertical pressure variation in the atmosphere,
cooling of an object, and radioactiv decay.

<span class="k">\section</span><span class="nb">{</span>Numerical solution method<span class="nb">}</span>
<span class="k">\label</span><span class="nb">{</span>numerical:problem<span class="nb">}</span>
<span class="k">\index</span><span class="nb">{</span>mesh in time<span class="nb">}</span> <span class="k">\index</span><span class="nb">{</span><span class="s">$</span><span class="nv">\theta</span><span class="s">$</span>-rule<span class="nb">}</span> <span class="k">\index</span><span class="nb">{</span>numerical scheme<span class="nb">}</span>
<span class="k">\index</span><span class="nb">{</span>finite difference scheme<span class="nb">}</span>

We introduce a mesh in time with points <span class="s">$</span><span class="m">0</span><span class="o">=</span><span class="nb"> t_</span><span class="m">0</span><span class="nb">&lt; t_</span><span class="m">1</span><span class="nb"> </span><span class="nv">\cdots</span><span class="nb"></span>
<span class="nb">&lt; t_{N_t}</span><span class="o">=</span><span class="nb">T</span><span class="s">$</span>. For simplicity, we assume constant spacing <span class="s">$</span><span class="nv">\Delta</span><span class="nb"> t</span><span class="s">$</span>
between the mesh points: <span class="s">$</span><span class="nv">\Delta</span><span class="nb"> t </span><span class="o">=</span><span class="nb"> t_{n}</span><span class="o">-</span><span class="nb">t_{n</span><span class="o">-</span><span class="m">1</span><span class="nb">}</span><span class="s">$</span>,
<span class="s">$</span><span class="nb">n</span><span class="o">=</span><span class="m">1</span><span class="nb">,</span><span class="nv">\ldots</span><span class="nb">,N_t</span><span class="s">$</span>. Let <span class="s">$</span><span class="nb">u^n</span><span class="s">$</span> be the numerical approximation to the
exact solution at <span class="s">$</span><span class="nb">t_n</span><span class="s">$</span>.

The <span class="s">$</span><span class="nv">\theta</span><span class="s">$</span>-rule <span class="k">\cite</span><span class="nb">{</span>Iserles<span class="nb">_</span>2009<span class="nb">}</span>
is used to solve (<span class="k">\ref</span><span class="nb">{</span>ode<span class="nb">}</span>) numerically:

<span class="sb">\[</span><span class="nb"></span>
<span class="nb">u^{n</span><span class="o">+</span><span class="m">1</span><span class="nb">} </span><span class="o">=</span><span class="nb"> </span><span class="nv">\frac</span><span class="nb">{</span><span class="m">1</span><span class="nb"> </span><span class="o">-</span><span class="nb"> </span><span class="o">(</span><span class="m">1</span><span class="o">-</span><span class="nv">\theta</span><span class="o">)</span><span class="nb"> a</span><span class="nv">\Delta</span><span class="nb"> t}{</span><span class="m">1</span><span class="nb"> </span><span class="o">+</span><span class="nb"> </span><span class="nv">\theta</span><span class="nb"> a</span><span class="nv">\Delta</span><span class="nb"> t}u^n,</span>
<span class="s">\]</span>
for <span class="s">$</span><span class="nb">n</span><span class="o">=</span><span class="m">0</span><span class="nb">,</span><span class="m">1</span><span class="nb">,</span><span class="nv">\ldots</span><span class="nb">,N_t</span><span class="o">-</span><span class="m">1</span><span class="s">$</span>. This scheme corresponds to

<span class="k">\begin</span><span class="nb">{</span>itemize<span class="nb">}</span>
  <span class="k">\item</span> The Forward Euler scheme when <span class="s">$</span><span class="nv">\theta</span><span class="o">=</span><span class="m">0</span><span class="s">$</span>
  <span class="k">\item</span> The Backward Euler scheme when <span class="s">$</span><span class="nv">\theta</span><span class="o">=</span><span class="m">1</span><span class="s">$</span>
  <span class="k">\item</span> The Crank-Nicolson scheme when <span class="s">$</span><span class="nv">\theta</span><span class="o">=</span><span class="m">1</span><span class="o">/</span><span class="m">2</span><span class="s">$</span>
<span class="k">\end</span><span class="nb">{</span>itemize<span class="nb">}</span>

<span class="k">\section</span><span class="nb">{</span>Implementation<span class="nb">}</span>

The numerical method is implemented in a Python function
<span class="k">\cite</span><span class="nb">{</span>Langtangen<span class="nb">_</span>2012<span class="nb">}</span>:

<span class="k">\begin</span><span class="nb">{</span>quote<span class="nb">}</span>
<span class="k">\begin</span><span class="nb">{</span>verbatim<span class="nb">}</span>
def solver(I, a, T, dt, theta):
    &quot;&quot;&quot;Solve u&#39;=-a*u, u(0)=I, for t in (0,T] with steps of dt.&quot;&quot;&quot;
    dt = float(dt)           # avoid integer division
    Nt = int(round(T/dt))    # no of time intervals
    T = Nt*dt                # adjust T to fit time step dt
    u = zeros(Nt+1)          # array of u[n] values
    t = linspace(0, T, Nt+1) # time mesh

    u[0] = I                 # assign initial condition
    for n in range(0, Nt):   # n=0,1,...,Nt-1
        u[n+1] = (1 - (1-theta)*a*dt)/(1 + theta*dt*a)*u[n]
    return u, t
<span class="k">\end</span><span class="nb">{</span>verbatim<span class="nb">}</span>
<span class="k">\end</span><span class="nb">{</span>quote<span class="nb">}</span>

<span class="k">\section</span><span class="nb">{</span>Numerical experiments<span class="nb">}</span>
<span class="k">\index</span><span class="nb">{</span>numerical experiments<span class="nb">}</span>

We define a set of numerical experiments where <span class="s">$</span><span class="nb">I</span><span class="s">$</span>, <span class="s">$</span><span class="nb">a</span><span class="s">$</span>, and <span class="s">$</span><span class="nb">T</span><span class="s">$</span> are
fixed, while <span class="s">$</span><span class="nv">\Delta</span><span class="nb"> t</span><span class="s">$</span> and <span class="s">$</span><span class="nv">\theta</span><span class="s">$</span> are varied.
In particular, <span class="s">$</span><span class="nb">I</span><span class="o">=</span><span class="m">1</span><span class="s">$</span>, <span class="s">$</span><span class="nb">a</span><span class="o">=</span><span class="m">2</span><span class="s">$</span>, <span class="s">$</span><span class="nv">\Delta</span><span class="nb"> t </span><span class="o">=</span><span class="nb"> </span><span class="m">1</span><span class="nb">.</span><span class="m">25</span><span class="nb">, </span><span class="m">0</span><span class="nb">.</span><span class="m">75</span><span class="nb">, </span><span class="m">0</span><span class="nb">.</span><span class="m">5</span><span class="nb">, </span><span class="m">0</span><span class="nb">.</span><span class="m">1</span><span class="s">$</span>.

<span class="k">\subsection</span><span class="nb">{</span>The Backward Euler method<span class="nb">}</span>
<span class="k">\index</span><span class="nb">{</span>BE<span class="nb">}</span>

<span class="k">\begin</span><span class="nb">{</span>center<span class="nb">}</span>  <span class="c">% inline figure</span>
  <span class="k">\centerline</span><span class="nb">{</span><span class="k">\includegraphics</span><span class="na">[width=0.9\linewidth]</span><span class="nb">{</span>BE.png<span class="nb">}}</span>
<span class="k">\end</span><span class="nb">{</span>center<span class="nb">}</span>

<span class="k">\subsection</span><span class="nb">{</span>The Crank-Nicolson method<span class="nb">}</span>
<span class="k">\index</span><span class="nb">{</span>CN<span class="nb">}</span>

<span class="k">\begin</span><span class="nb">{</span>center<span class="nb">}</span>  <span class="c">% inline figure</span>
  <span class="k">\centerline</span><span class="nb">{</span><span class="k">\includegraphics</span><span class="na">[width=0.9\linewidth]</span><span class="nb">{</span>CN.png<span class="nb">}}</span>
<span class="k">\end</span><span class="nb">{</span>center<span class="nb">}</span>

<span class="k">\subsection</span><span class="nb">{</span>The Forward Euler method<span class="nb">}</span>
<span class="k">\index</span><span class="nb">{</span>FE<span class="nb">}</span>

<span class="k">\begin</span><span class="nb">{</span>center<span class="nb">}</span>  <span class="c">% inline figure</span>
  <span class="k">\centerline</span><span class="nb">{</span><span class="k">\includegraphics</span><span class="na">[width=0.9\linewidth]</span><span class="nb">{</span>FE.png<span class="nb">}}</span>
<span class="k">\end</span><span class="nb">{</span>center<span class="nb">}</span>

<span class="k">\subsection</span><span class="nb">{</span>Error vs <span class="s">$</span><span class="nv">\Delta</span><span class="nb"> t</span><span class="s">$</span><span class="nb">}</span>
<span class="k">\index</span><span class="nb">{</span>error vs time step<span class="nb">}</span>

How <span class="s">$</span><span class="nb">E</span><span class="s">$</span> varies with <span class="s">$</span><span class="nv">\Delta</span><span class="nb"> t</span><span class="s">$</span> for <span class="s">$</span><span class="nv">\theta</span><span class="o">=</span><span class="m">0</span><span class="nb">,</span><span class="m">0</span><span class="nb">.</span><span class="m">5</span><span class="nb">,</span><span class="m">1</span><span class="s">$</span>
is shown in Figure~<span class="k">\ref</span><span class="nb">{</span>fig:E<span class="nb">}</span>.

<span class="k">\paragraph</span><span class="nb">{</span>Observe:<span class="nb">}</span>
The data points for the three largest <span class="s">$</span><span class="nv">\Delta</span><span class="nb"> t</span><span class="s">$</span> values in the
Forward Euler method are not relevant as the solution behaves
non-physically.

<span class="k">\begin</span><span class="nb">{</span>figure<span class="nb">}</span>[!ht]
  <span class="k">\centerline</span><span class="nb">{</span><span class="k">\includegraphics</span><span class="na">[width=0.9\linewidth]</span><span class="nb">{</span>error.png<span class="nb">}}</span>
  <span class="k">\caption</span><span class="nb">{</span>
  Error versus time step. <span class="k">\label</span><span class="nb">{</span>fig:E<span class="nb">}</span>
  <span class="nb">}</span>
<span class="k">\end</span><span class="nb">{</span>figure<span class="nb">}</span>

<span class="k">\subsection</span><span class="nb">{</span>Summary<span class="nb">}</span>

<span class="k">\begin</span><span class="nb">{</span>enumerate<span class="nb">}</span>
<span class="k">\item</span> <span class="s">$</span><span class="nv">\theta</span><span class="nb"> </span><span class="o">=</span><span class="m">1</span><span class="s">$</span>: <span class="s">$</span><span class="nb">E</span><span class="nv">\sim</span><span class="nb"> </span><span class="nv">\Delta</span><span class="nb"> t</span><span class="s">$</span> (first-order convergence).
<span class="k">\item</span> <span class="s">$</span><span class="nv">\theta</span><span class="nb"> </span><span class="o">=</span><span class="m">0</span><span class="nb">.</span><span class="m">5</span><span class="s">$</span>: <span class="s">$</span><span class="nb">E</span><span class="nv">\sim</span><span class="nb"> </span><span class="nv">\Delta</span><span class="nb"> t^</span><span class="m">2</span><span class="s">$</span> (second-order convergence).
<span class="k">\item</span> <span class="s">$</span><span class="nv">\theta</span><span class="nb"> </span><span class="o">=</span><span class="m">1</span><span class="s">$</span> is always stable and gives qualitatively corrects results.
<span class="k">\item</span> <span class="s">$</span><span class="nv">\theta</span><span class="nb"> </span><span class="o">=</span><span class="m">0</span><span class="nb">.</span><span class="m">5</span><span class="s">$</span> never blows up, but may give oscillating solutions
if <span class="s">$</span><span class="nv">\Delta</span><span class="nb"> t</span><span class="s">$</span> is not sufficiently small.
<span class="k">\item</span> <span class="s">$</span><span class="nv">\theta</span><span class="nb"> </span><span class="o">=</span><span class="m">0</span><span class="s">$</span> suffers from fast-growing solution if <span class="s">$</span><span class="nv">\Delta</span><span class="nb"> t</span><span class="s">$</span> is
not small enough, but even below this limit one can have oscillating
solutions that disappear if <span class="s">$</span><span class="nv">\Delta</span><span class="nb"> t</span><span class="s">$</span> is sufficiently small.
<span class="k">\end</span><span class="nb">{</span>enumerate<span class="nb">}</span>

<span class="c">% BibTeX is used to handle references:</span>

<span class="k">\bibliographystyle</span><span class="nb">{</span>plain<span class="nb">}</span>
<span class="k">\bibliography</span><span class="nb">{</span>refs<span class="nb">}</span>

<span class="k">\printindex</span>
<span class="k">\end</span><span class="nb">{</span>document<span class="nb">}</span>
</pre></div>
</body>
</html>
