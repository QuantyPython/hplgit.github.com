<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN"
   "http://www.w3.org/TR/html4/strict.dtd">

<html>
<head>
  <title></title>
  <meta http-equiv="content-type" content="text/html; charset=latin1">
  <style type="text/css">
td.linenos { background-color: #f0f0f0; padding-right: 10px; }
span.lineno { background-color: #f0f0f0; padding: 0 5px 0 5px; }
pre { line-height: 125%; }
body .hll { background-color: #ffffcc }
body  { background: #f8f8f8; }
body .c { color: #008800; font-style: italic } /* Comment */
body .err { border: 1px solid #FF0000 } /* Error */
body .k { color: #AA22FF; font-weight: bold } /* Keyword */
body .o { color: #666666 } /* Operator */
body .cm { color: #008800; font-style: italic } /* Comment.Multiline */
body .cp { color: #008800 } /* Comment.Preproc */
body .c1 { color: #008800; font-style: italic } /* Comment.Single */
body .cs { color: #008800; font-weight: bold } /* Comment.Special */
body .gd { color: #A00000 } /* Generic.Deleted */
body .ge { font-style: italic } /* Generic.Emph */
body .gr { color: #FF0000 } /* Generic.Error */
body .gh { color: #000080; font-weight: bold } /* Generic.Heading */
body .gi { color: #00A000 } /* Generic.Inserted */
body .go { color: #888888 } /* Generic.Output */
body .gp { color: #000080; font-weight: bold } /* Generic.Prompt */
body .gs { font-weight: bold } /* Generic.Strong */
body .gu { color: #800080; font-weight: bold } /* Generic.Subheading */
body .gt { color: #0044DD } /* Generic.Traceback */
body .kc { color: #AA22FF; font-weight: bold } /* Keyword.Constant */
body .kd { color: #AA22FF; font-weight: bold } /* Keyword.Declaration */
body .kn { color: #AA22FF; font-weight: bold } /* Keyword.Namespace */
body .kp { color: #AA22FF } /* Keyword.Pseudo */
body .kr { color: #AA22FF; font-weight: bold } /* Keyword.Reserved */
body .kt { color: #00BB00; font-weight: bold } /* Keyword.Type */
body .m { color: #666666 } /* Literal.Number */
body .s { color: #BB4444 } /* Literal.String */
body .na { color: #BB4444 } /* Name.Attribute */
body .nb { color: #AA22FF } /* Name.Builtin */
body .nc { color: #0000FF } /* Name.Class */
body .no { color: #880000 } /* Name.Constant */
body .nd { color: #AA22FF } /* Name.Decorator */
body .ni { color: #999999; font-weight: bold } /* Name.Entity */
body .ne { color: #D2413A; font-weight: bold } /* Name.Exception */
body .nf { color: #00A000 } /* Name.Function */
body .nl { color: #A0A000 } /* Name.Label */
body .nn { color: #0000FF; font-weight: bold } /* Name.Namespace */
body .nt { color: #008000; font-weight: bold } /* Name.Tag */
body .nv { color: #B8860B } /* Name.Variable */
body .ow { color: #AA22FF; font-weight: bold } /* Operator.Word */
body .w { color: #bbbbbb } /* Text.Whitespace */
body .mf { color: #666666 } /* Literal.Number.Float */
body .mh { color: #666666 } /* Literal.Number.Hex */
body .mi { color: #666666 } /* Literal.Number.Integer */
body .mo { color: #666666 } /* Literal.Number.Oct */
body .sb { color: #BB4444 } /* Literal.String.Backtick */
body .sc { color: #BB4444 } /* Literal.String.Char */
body .sd { color: #BB4444; font-style: italic } /* Literal.String.Doc */
body .s2 { color: #BB4444 } /* Literal.String.Double */
body .se { color: #BB6622; font-weight: bold } /* Literal.String.Escape */
body .sh { color: #BB4444 } /* Literal.String.Heredoc */
body .si { color: #BB6688; font-weight: bold } /* Literal.String.Interpol */
body .sx { color: #008000 } /* Literal.String.Other */
body .sr { color: #BB6688 } /* Literal.String.Regex */
body .s1 { color: #BB4444 } /* Literal.String.Single */
body .ss { color: #B8860B } /* Literal.String.Symbol */
body .bp { color: #AA22FF } /* Name.Builtin.Pseudo */
body .vc { color: #B8860B } /* Name.Variable.Class */
body .vg { color: #B8860B } /* Name.Variable.Global */
body .vi { color: #B8860B } /* Name.Variable.Instance */
body .il { color: #666666 } /* Literal.Number.Integer.Long */

  </style>
</head>
<body>
<h2></h2>

<div class="highlight"><pre>{
 &quot;metadata&quot;: {},
 &quot;nbformat&quot;: 3,
 &quot;nbformat_minor&quot;: 0,
 &quot;worksheets&quot;: [
  {
   &quot;cells&quot;: [
    {
     &quot;cell_type&quot;: &quot;markdown&quot;,
     &quot;metadata&quot;: {},
     &quot;source&quot;: [
      &quot;# Experiments with Schemes for Exponential Decay\n&quot;,
      &quot;_Jun 18, 2013_\n&quot;,
      &quot;\n&quot;,
      &quot;*Summary.* This report investigates the accuracy of three finite difference\n&quot;,
      &quot;schemes for the ordinary differential equation $u&#39;=-au$ with the\n&quot;,
      &quot;aid of numerical experiments. Numerical artifacts are in particular\n&quot;,
      &quot;demonstrated.\n&quot;,
      &quot;\n&quot;,
      &quot;\n&quot;,
      &quot;\n&quot;,
      &quot;\n&quot;,
      &quot;\n&quot;,
      &quot;\n&quot;,
      &quot;\n&quot;,
      &quot;\n&quot;,
      &quot;\n&quot;,
      &quot;\n&quot;,
      &quot;## Mathematical problem\n&quot;,
      &quot;\n&quot;,
      &quot;\n&quot;,
      &quot;We address the initial-value problem&quot;
     ]
    },
    {
     &quot;cell_type&quot;: &quot;markdown&quot;,
     &quot;metadata&quot;: {},
     &quot;source&quot;: [
      &quot;$$\n&quot;,
      &quot;\\begin{equation}\n&quot;,
      &quot;u&#39;(t) = -au(t), \\quad t \\in (0,T], \\label{ode}\n&quot;,
      &quot;\\end{equation}\n&quot;,
      &quot;$$&quot;
     ]
    },
    {
     &quot;cell_type&quot;: &quot;markdown&quot;,
     &quot;metadata&quot;: {},
     &quot;source&quot;: [
      &quot;$$\n&quot;,
      &quot;\\begin{equation} \n&quot;,
      &quot;u(0)  = I,                         \\label{initial:value}\n&quot;,
      &quot;\\end{equation}\n&quot;,
      &quot;$$&quot;
     ]
    },
    {
     &quot;cell_type&quot;: &quot;markdown&quot;,
     &quot;metadata&quot;: {},
     &quot;source&quot;: [
      &quot;where $a$, $I$, and $T$ are prescribed parameters, and $u(t)$ is\n&quot;,
      &quot;the unknown function to be estimated. This mathematical model\n&quot;,
      &quot;is relevant for physical phenomena featuring exponential decay\n&quot;,
      &quot;in time, e.g., vertical pressure variation in the atmosphere,\n&quot;,
      &quot;cooling of an object, and radioactive decay.\n&quot;,
      &quot;\n&quot;,
      &quot;## Numerical solution method\n&quot;,
      &quot;\n&quot;,
      &quot;\n&quot;,
      &quot;We introduce a mesh in time with points $0= t_0&lt; t_1 \\cdots &lt; t_{N_t}=T$.\n&quot;,
      &quot;For simplicity, we assume constant spacing $\\Delta t$ between the\n&quot;,
      &quot;mesh points: $\\Delta t = t_{n}-t_{n-1}$, $n=1,\\ldots,N_t$. Let\n&quot;,
      &quot;$u^n$ be the numerical approximation to the exact solution at $t_n$.\n&quot;,
      &quot;\n&quot;,
      &quot;The $\\theta$-rule [Iserles_2009]\n&quot;,
      &quot;is used to solve Eq (ode) numerically:&quot;
     ]
    },
    {
     &quot;cell_type&quot;: &quot;markdown&quot;,
     &quot;metadata&quot;: {},
     &quot;source&quot;: [
      &quot;$$\n&quot;,
      &quot;u^{n+1} = \\frac{1 - (1-\\theta) a\\Delta t}{1 + \\theta a\\Delta t}u^n,\n&quot;,
      &quot;$$&quot;
     ]
    },
    {
     &quot;cell_type&quot;: &quot;markdown&quot;,
     &quot;metadata&quot;: {},
     &quot;source&quot;: [
      &quot;for $n=0,1,\\ldots,N_t-1$. This scheme corresponds to\n&quot;,
      &quot;\n&quot;,
      &quot;  * The [Forward Euler](http://en.wikipedia.org/wiki/Forward_Euler_method)\n&quot;,
      &quot;    scheme when $\\theta=0$\n&quot;,
      &quot;\n&quot;,
      &quot;  * The [Backward Euler](http://en.wikipedia.org/wiki/Backward_Euler_method)\n&quot;,
      &quot;    scheme when $\\theta=1$\n&quot;,
      &quot;\n&quot;,
      &quot;  * The [Crank-Nicolson](http://en.wikipedia.org/wiki/Crank-Nicolson)\n&quot;,
      &quot;    scheme when $\\theta=1/2$\n&quot;,
      &quot;\n&quot;,
      &quot;## Implementation\n&quot;,
      &quot;\n&quot;,
      &quot;\n&quot;,
      &quot;The numerical method is implemented in a Python function\n&quot;,
      &quot;[Langtangen_2012] `solver` (found in the [`decay_mod`](https://github.com/hplgit/INF5620/blob/gh-pages/src/decay/experiments/dc_mod.py) module):&quot;
     ]
    },
    {
     &quot;cell_type&quot;: &quot;code&quot;,
     &quot;collapsed&quot;: false,
     &quot;input&quot;: [
      &quot;def solver(I, a, T, dt, theta):\n&quot;,
      &quot;    \&quot;\&quot;\&quot;Solve u&#39;=-a*u, u(0)=I, for t in (0,T] with steps of dt.\&quot;\&quot;\&quot;\n&quot;,
      &quot;    dt = float(dt)            # avoid integer division\n&quot;,
      &quot;    Nt = int(round(T/dt))     # no of time intervals\n&quot;,
      &quot;    T = Nt*dt                 # adjust T to fit time step dt\n&quot;,
      &quot;    u = zeros(Nt+1)           # array of u[n] values\n&quot;,
      &quot;    t = linspace(0, T, Nt+1)  # time mesh\n&quot;,
      &quot;\n&quot;,
      &quot;    u[0] = I                  # assign initial condition\n&quot;,
      &quot;    for n in range(0, Nt):    # n=0,1,...,Nt-1\n&quot;,
      &quot;        u[n+1] = (1 - (1-theta)*a*dt)/(1 + theta*dt*a)*u[n]\n&quot;,
      &quot;    return u, t\n&quot;
     ],
     &quot;language&quot;: &quot;python&quot;,
     &quot;metadata&quot;: {},
     &quot;outputs&quot;: [],
     &quot;prompt_number&quot;: 1
    },
    {
     &quot;cell_type&quot;: &quot;markdown&quot;,
     &quot;metadata&quot;: {},
     &quot;source&quot;: [
      &quot;## Numerical experiments\n&quot;,
      &quot;\n&quot;,
      &quot;\n&quot;,
      &quot;\n&quot;,
      &quot;We define a set of numerical experiments where $I$, $a$, and $T$ are\n&quot;,
      &quot;fixed, while $\\Delta t$ and $\\theta$ are varied.\n&quot;,
      &quot;In particular, $I=1$, $a=2$, $\\Delta t = 1.25, 0.75, 0.5, 0.1$.\n&quot;,
      &quot;\n&quot;,
      &quot;\n&quot;,
      &quot;\n&quot;,
      &quot;### The Backward Euler method\n&quot;,
      &quot;\n&quot;,
      &quot;\n&quot;,
      &quot;\n&quot;,
      &quot;\n&quot;,
      &quot;![](files/BE.png)\n&quot;,
      &quot;\n&quot;,
      &quot;\n&quot;,
      &quot;\n&quot;,
      &quot;### The Crank-Nicolson method\n&quot;,
      &quot;\n&quot;,
      &quot;\n&quot;,
      &quot;\n&quot;,
      &quot;\n&quot;,
      &quot;![](files/CN.png)\n&quot;,
      &quot;\n&quot;,
      &quot;\n&quot;,
      &quot;\n&quot;,
      &quot;### The Forward Euler method\n&quot;,
      &quot;\n&quot;,
      &quot;\n&quot;,
      &quot;\n&quot;,
      &quot;\n&quot;,
      &quot;![](files/FE.png)\n&quot;,
      &quot;\n&quot;,
      &quot;\n&quot;,
      &quot;\n&quot;,
      &quot;### Error vs $\\Delta t$\n&quot;,
      &quot;\n&quot;,
      &quot;\n&quot;,
      &quot;\n&quot;,
      &quot;How $E$ varies with $\\Delta t$ for $\\theta=0,0.5,1$\n&quot;,
      &quot;is shown below.\n&quot;,
      &quot;\n&quot;,
      &quot;\n&quot;,
      &quot;!bwarning Observe:\n&quot;,
      &quot;The data points for the three largest $\\Delta t$ values in the\n&quot;,
      &quot;Forward Euler method are not relevant as the solution behaves\n&quot;,
      &quot;non-physically.\n&quot;,
      &quot;!ewarning\n&quot;,
      &quot;\n&quot;,
      &quot;\n&quot;,
      &quot;![](files/error.png)\n&quot;,
      &quot;\n&quot;,
      &quot;\n&quot;,
      &quot;!bsummary\n&quot;,
      &quot;1. $\\theta =1$: $E\\sim \\Delta t$ (first-order convergence).\n&quot;,
      &quot;\n&quot;,
      &quot;2. $\\theta =0.5$: $E\\sim \\Delta t^2$ (second-order convergence).\n&quot;,
      &quot;\n&quot;,
      &quot;3. $\\theta =1$ is always stable and gives qualitatively corrects results.\n&quot;,
      &quot;\n&quot;,
      &quot;4. $\\theta =0.5$ never blows up, but may give oscillating solutions\n&quot;,
      &quot;   if $\\Delta t$ is not sufficiently small.\n&quot;,
      &quot;\n&quot;,
      &quot;5. $\\theta =0$ suffers from fast-growing solution if $\\Delta t$ is\n&quot;,
      &quot;   not small enough, but even below this limit one can have oscillating\n&quot;,
      &quot;   solutions that disappear if $\\Delta t$ is sufficiently small.\n&quot;,
      &quot;\n&quot;,
      &quot;!esummary\n&quot;,
      &quot;\n&quot;,
      &quot;\n&quot;,
      &quot;\n&quot;,
      &quot;## Bibliography\n&quot;,
      &quot;\n&quot;,
      &quot; 1. \\label{Iserles_2009} _A. Iserles_. \n&quot;,
      &quot;    *A First Course in the Numerical Analysis of Differential Equations*,\n&quot;,
      &quot;    Cambridge University Press,\n&quot;,
      &quot;    2009.\n&quot;,
      &quot;\n&quot;,
      &quot; 2. \\label{Langtangen_2012} _H. P. Langtangen_. \n&quot;,
      &quot;    *A Primer on Scientific Programming With Python*,\n&quot;,
      &quot;    Springer,\n&quot;,
      &quot;    2012.&quot;
     ]
    }
   ],
   &quot;metadata&quot;: {}
  }
 ]
}
</pre></div>
</body>
</html>
