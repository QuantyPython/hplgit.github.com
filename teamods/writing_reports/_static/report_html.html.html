<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN"
   "http://www.w3.org/TR/html4/strict.dtd">

<html>
<head>
  <title></title>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <style type="text/css">
td.linenos { background-color: #f0f0f0; padding-right: 10px; }
span.lineno { background-color: #f0f0f0; padding: 0 5px 0 5px; }
pre { line-height: 125%; }
body .hll { background-color: #ffffcc }
body  { background: #f8f8f8; }
body .c { color: #008800; font-style: italic } /* Comment */
body  .err { border: 0; } /* drop error */
body .k { color: #AA22FF; font-weight: bold } /* Keyword */
body .o { color: #666666 } /* Operator */
body .ch { color: #008800; font-style: italic } /* Comment.Hashbang */
body .cm { color: #008800; font-style: italic } /* Comment.Multiline */
body .cp { color: #008800 } /* Comment.Preproc */
body .cpf { color: #008800; font-style: italic } /* Comment.PreprocFile */
body .c1 { color: #008800; font-style: italic } /* Comment.Single */
body .cs { color: #008800; font-weight: bold } /* Comment.Special */
body .gd { color: #A00000 } /* Generic.Deleted */
body .ge { font-style: italic } /* Generic.Emph */
body .gr { color: #FF0000 } /* Generic.Error */
body .gh { color: #000080; font-weight: bold } /* Generic.Heading */
body .gi { color: #00A000 } /* Generic.Inserted */
body .go { color: #888888 } /* Generic.Output */
body .gp { color: #000080; font-weight: bold } /* Generic.Prompt */
body .gs { font-weight: bold } /* Generic.Strong */
body .gu { color: #800080; font-weight: bold } /* Generic.Subheading */
body .gt { color: #0044DD } /* Generic.Traceback */
body .kc { color: #AA22FF; font-weight: bold } /* Keyword.Constant */
body .kd { color: #AA22FF; font-weight: bold } /* Keyword.Declaration */
body .kn { color: #AA22FF; font-weight: bold } /* Keyword.Namespace */
body .kp { color: #AA22FF } /* Keyword.Pseudo */
body .kr { color: #AA22FF; font-weight: bold } /* Keyword.Reserved */
body .kt { color: #00BB00; font-weight: bold } /* Keyword.Type */
body .m { color: #666666 } /* Literal.Number */
body .s { color: #BB4444 } /* Literal.String */
body .na { color: #BB4444 } /* Name.Attribute */
body .nb { color: #AA22FF } /* Name.Builtin */
body .nc { color: #0000FF } /* Name.Class */
body .no { color: #880000 } /* Name.Constant */
body .nd { color: #AA22FF } /* Name.Decorator */
body .ni { color: #999999; font-weight: bold } /* Name.Entity */
body .ne { color: #D2413A; font-weight: bold } /* Name.Exception */
body .nf { color: #00A000 } /* Name.Function */
body .nl { color: #A0A000 } /* Name.Label */
body .nn { color: #0000FF; font-weight: bold } /* Name.Namespace */
body .nt { color: #008000; font-weight: bold } /* Name.Tag */
body .nv { color: #B8860B } /* Name.Variable */
body .ow { color: #AA22FF; font-weight: bold } /* Operator.Word */
body .w { color: #bbbbbb } /* Text.Whitespace */
body .mb { color: #666666 } /* Literal.Number.Bin */
body .mf { color: #666666 } /* Literal.Number.Float */
body .mh { color: #666666 } /* Literal.Number.Hex */
body .mi { color: #666666 } /* Literal.Number.Integer */
body .mo { color: #666666 } /* Literal.Number.Oct */
body .sb { color: #BB4444 } /* Literal.String.Backtick */
body .sc { color: #BB4444 } /* Literal.String.Char */
body .sd { color: #BB4444; font-style: italic } /* Literal.String.Doc */
body .s2 { color: #BB4444 } /* Literal.String.Double */
body .se { color: #BB6622; font-weight: bold } /* Literal.String.Escape */
body .sh { color: #BB4444 } /* Literal.String.Heredoc */
body .si { color: #BB6688; font-weight: bold } /* Literal.String.Interpol */
body .sx { color: #008000 } /* Literal.String.Other */
body .sr { color: #BB6688 } /* Literal.String.Regex */
body .s1 { color: #BB4444 } /* Literal.String.Single */
body .ss { color: #B8860B } /* Literal.String.Symbol */
body .bp { color: #AA22FF } /* Name.Builtin.Pseudo */
body .vc { color: #B8860B } /* Name.Variable.Class */
body .vg { color: #B8860B } /* Name.Variable.Global */
body .vi { color: #B8860B } /* Name.Variable.Instance */
body .il { color: #666666 } /* Literal.Number.Integer.Long */

  </style>
</head>
<body>
<h2></h2>

<div class="highlight"><pre><span></span><span class="p">&lt;</span><span class="nt">html</span><span class="p">&gt;</span>
<span class="p">&lt;</span><span class="nt">head</span><span class="p">&gt;&lt;/</span><span class="nt">head</span><span class="p">&gt;</span>
<span class="p">&lt;</span><span class="nt">body</span> <span class="na">bgcolor</span><span class="o">=</span><span class="s">&quot;white&quot;</span><span class="p">&gt;</span>

<span class="p">&lt;</span><span class="nt">title</span><span class="p">&gt;</span>Numerical investigations<span class="p">&lt;/</span><span class="nt">title</span><span class="p">&gt;</span>

<span class="p">&lt;</span><span class="nt">center</span><span class="p">&gt;&lt;</span><span class="nt">h1</span><span class="p">&gt;</span>Experiments with Schemes for Exponential Decay<span class="p">&lt;/</span><span class="nt">h1</span><span class="p">&gt;&lt;/</span><span class="nt">center</span><span class="p">&gt;</span>

<span class="p">&lt;</span><span class="nt">center</span><span class="p">&gt;&lt;</span><span class="nt">b</span><span class="p">&gt;</span>Hans Petter Langtangen<span class="p">&lt;/</span><span class="nt">b</span><span class="p">&gt;&lt;/</span><span class="nt">center</span><span class="p">&gt;</span>
<span class="p">&lt;</span><span class="nt">center</span><span class="p">&gt;&lt;</span><span class="nt">b</span><span class="p">&gt;</span>Simula Research Laboratory<span class="p">&lt;/</span><span class="nt">b</span><span class="p">&gt;&lt;/</span><span class="nt">center</span><span class="p">&gt;</span>
<span class="p">&lt;</span><span class="nt">center</span><span class="p">&gt;&lt;</span><span class="nt">b</span><span class="p">&gt;</span>University of Oslo<span class="p">&lt;/</span><span class="nt">b</span><span class="p">&gt;&lt;/</span><span class="nt">center</span><span class="p">&gt;</span>
<span class="p">&lt;</span><span class="nt">center</span><span class="p">&gt;&lt;</span><span class="nt">h4</span><span class="p">&gt;</span>August 20, 2012<span class="p">&lt;/</span><span class="nt">h4</span><span class="p">&gt;&lt;/</span><span class="nt">center</span><span class="p">&gt;</span>

<span class="p">&lt;</span><span class="nt">b</span><span class="p">&gt;</span>Summary.<span class="p">&lt;/</span><span class="nt">b</span><span class="p">&gt;</span> This report investigates the accuracy of three
finite difference schemes for the ordinary differential equation
u&#39;=-au with the aid of numerical experiments.  Numerical
artifacts are in particular demonstrated.

<span class="p">&lt;</span><span class="nt">h2</span><span class="p">&gt;</span>Mathematical problem<span class="p">&lt;/</span><span class="nt">h2</span><span class="p">&gt;</span>

We address the initial-value problem u&#39;(t)=-au(t),
for t in (0,T], and with initial condition u(0)=I.
Here, I, a, and T are prescribed parameters,
and u(t) is the unknown function to be estimated.
This mathematical model is relevant for physical
phenomena featuring exponential decay in time,
e.g., vertical pressure variation in the atmosphere,
cooling of an object, and radioactive decay.

<span class="p">&lt;</span><span class="nt">h2</span><span class="p">&gt;</span>Numerical solution method<span class="p">&lt;/</span><span class="nt">h2</span><span class="p">&gt;</span>

We use a mesh in time with equally spaced points.
The theta-rule <span class="p">&lt;</span><span class="nt">a</span> <span class="na">href</span><span class="o">=</span><span class="s">&quot;#Iserles_2009&quot;</span><span class="p">&gt;</span>[1]<span class="p">&lt;/</span><span class="nt">a</span><span class="p">&gt;</span>
is used to discretize the differential
equation. This scheme corresponds to

<span class="p">&lt;</span><span class="nt">ul</span><span class="p">&gt;</span>
  <span class="p">&lt;</span><span class="nt">li</span><span class="p">&gt;</span> The Forward Euler scheme when theta=0
  <span class="p">&lt;</span><span class="nt">li</span><span class="p">&gt;</span> The Backward Euler scheme when theta=1
  <span class="p">&lt;</span><span class="nt">li</span><span class="p">&gt;</span> The Crank-Nicolson scheme when theta=1/2
<span class="p">&lt;/</span><span class="nt">ul</span><span class="p">&gt;</span>

<span class="p">&lt;</span><span class="nt">h2</span><span class="p">&gt;</span>Implementation<span class="p">&lt;/</span><span class="nt">h2</span><span class="p">&gt;</span>

The numerical method is implemented in a Python function
<span class="p">&lt;</span><span class="nt">a</span> <span class="na">href</span><span class="o">=</span><span class="s">&quot;#Langtangen_2012&quot;</span><span class="p">&gt;</span>[2]<span class="p">&lt;/</span><span class="nt">a</span><span class="p">&gt;</span>:

<span class="p">&lt;</span><span class="nt">pre</span><span class="p">&gt;</span>
def solver(I, a, T, dt, theta):
    &quot;&quot;&quot;Solve u&#39;=-a*u, u(0)=I, for t in (0,T] with steps of dt.&quot;&quot;&quot;
    Nt = int(round(T/float(dt)))  # no of intervals
    u = zeros(Nt+1)
    t = linspace(0, T, Nt+1)

    u[0] = I
    for n in range(0, Nt):
        u[n+1] = (1 - (1-theta)*a*dt)/(1 + theta*dt*a)*u[n]
    return u, t
<span class="p">&lt;/</span><span class="nt">pre</span><span class="p">&gt;</span>

<span class="p">&lt;</span><span class="nt">h2</span><span class="p">&gt;</span>Numerical experiments<span class="p">&lt;/</span><span class="nt">h2</span><span class="p">&gt;</span>

We define a set of numerical experiments where I, a, and
T are fixed, while the time step and theta are varied.
In particular, I=1, a=2, dt=1.25, 0.75, 0.5, 0.1.


<span class="p">&lt;</span><span class="nt">h3</span><span class="p">&gt;</span>The Backward Euler method<span class="p">&lt;/</span><span class="nt">h3</span><span class="p">&gt;</span>
<span class="p">&lt;</span><span class="nt">img</span> <span class="na">src</span><span class="o">=</span><span class="s">&quot;BE.png&quot;</span> <span class="na">width</span><span class="o">=</span><span class="s">&quot;800&quot;</span><span class="p">&gt;</span>


<span class="p">&lt;</span><span class="nt">h3</span><span class="p">&gt;</span>The Crank-Nicolson method<span class="p">&lt;/</span><span class="nt">h3</span><span class="p">&gt;</span>
<span class="p">&lt;</span><span class="nt">img</span> <span class="na">src</span><span class="o">=</span><span class="s">&quot;CN.png&quot;</span> <span class="na">width</span><span class="o">=</span><span class="s">&quot;800&quot;</span><span class="p">&gt;</span>


<span class="p">&lt;</span><span class="nt">h3</span><span class="p">&gt;</span>The Forward Euler method<span class="p">&lt;/</span><span class="nt">h3</span><span class="p">&gt;</span>
<span class="p">&lt;</span><span class="nt">img</span> <span class="na">src</span><span class="o">=</span><span class="s">&quot;FE.png&quot;</span> <span class="na">width</span><span class="o">=</span><span class="s">&quot;800&quot;</span><span class="p">&gt;</span>



<span class="p">&lt;</span><span class="nt">h3</span><span class="p">&gt;</span>Error versus time discretization<span class="p">&lt;/</span><span class="nt">h3</span><span class="p">&gt;</span>

How E varies with the time step, for the three discretization
methods, is shown below.

<span class="p">&lt;</span><span class="nt">p</span><span class="p">&gt;&lt;</span><span class="nt">b</span><span class="p">&gt;</span>Observe:<span class="p">&lt;/</span><span class="nt">b</span><span class="p">&gt;</span>
The data points for the three largest time steps in the
Forward Euler method are not relevant as the solution behaves
non-physically.

<span class="p">&lt;</span><span class="nt">p</span><span class="p">&gt;</span>
<span class="p">&lt;</span><span class="nt">img</span><span class="err">=&quot;</span><span class="na">error</span><span class="err">.</span><span class="na">png</span><span class="err">&quot;,</span> <span class="na">width</span><span class="o">=</span><span class="s">&quot;400&quot;</span><span class="p">&gt;</span>

<span class="p">&lt;</span><span class="nt">h3</span><span class="p">&gt;</span>Summary<span class="p">&lt;/</span><span class="nt">h3</span><span class="p">&gt;</span>

<span class="p">&lt;</span><span class="nt">ol</span><span class="p">&gt;</span>
  <span class="p">&lt;</span><span class="nt">li</span><span class="p">&gt;</span> For the Backward Euler scheme, we have
       first-order convergence.
  <span class="p">&lt;</span><span class="nt">li</span><span class="p">&gt;</span> For the Crank-Nicolson scheme, we have second-order convergence.
  <span class="p">&lt;</span><span class="nt">li</span><span class="p">&gt;</span> The Backward Euler scheme is always stable and gives
       qualitatively corrects results.
  <span class="p">&lt;</span><span class="nt">li</span><span class="p">&gt;</span> The Crank-Nicolson scheme never blows up, but may give
       oscillating solutions if the time step is not sufficiently small.
  <span class="p">&lt;</span><span class="nt">li</span><span class="p">&gt;</span> The Forward Euler scheme suffers from fast-growing solution
       if time time step is not small enough, but even below this
       limit one can have oscillating solutions (unless
       the time step is sufficiently small).
<span class="p">&lt;/</span><span class="nt">ol</span><span class="p">&gt;</span>

<span class="p">&lt;</span><span class="nt">h3</span><span class="p">&gt;</span>Bibliography<span class="p">&lt;/</span><span class="nt">h3</span><span class="p">&gt;</span>

<span class="p">&lt;</span><span class="nt">ol</span><span class="p">&gt;</span>
 <span class="p">&lt;</span><span class="nt">li</span><span class="p">&gt;</span> <span class="p">&lt;</span><span class="nt">a</span> <span class="na">name</span><span class="o">=</span><span class="s">&quot;Iserles_2009&quot;</span><span class="p">&gt;&lt;/</span><span class="nt">a</span><span class="p">&gt;</span> <span class="p">&lt;</span><span class="nt">b</span><span class="p">&gt;</span>A. Iserles<span class="p">&lt;/</span><span class="nt">b</span><span class="p">&gt;</span>.
    A First Course in the Numerical Analysis of Differential Equations,
    Cambridge University Press, 2009.
 <span class="p">&lt;</span><span class="nt">li</span><span class="p">&gt;</span> <span class="p">&lt;</span><span class="nt">a</span> <span class="na">name</span><span class="o">=</span><span class="s">&quot;Langtangen_2012&quot;</span><span class="p">&gt;&lt;/</span><span class="nt">a</span><span class="p">&gt;</span> <span class="p">&lt;</span><span class="nt">b</span><span class="p">&gt;</span>H. P. Langtangen<span class="p">&lt;/</span><span class="nt">b</span><span class="p">&gt;</span>.
    A Primer on Scientific Programming With Python,
    Springer, 2012.
<span class="p">&lt;/</span><span class="nt">ol</span><span class="p">&gt;</span>

<span class="p">&lt;/</span><span class="nt">body</span><span class="p">&gt;</span>
<span class="p">&lt;/</span><span class="nt">html</span><span class="p">&gt;</span>
</pre></div>
</body>
</html>
