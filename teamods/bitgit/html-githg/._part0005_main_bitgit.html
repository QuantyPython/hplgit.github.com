
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Using Git &mdash; Quick Intro to Version Control Systems (Git and Mercurial) and Project Hosting Services</title>
    
    <link rel="stylesheet" href="_static/pyramid.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '',
        VERSION:     '1.0',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="top" title="Quick Intro to Version Control Systems (Git and Mercurial) and Project Hosting Services" href="index.html" />
    <link rel="next" title="Using Mercurial" href="._part0006_main_bitgit.html" />
    <link rel="prev" title="GitHub" href="._part0004_main_bitgit.html" />
<link rel="stylesheet" href="http://fonts.googleapis.com/css?family=Neuton&amp;subset=latin" type="text/css" media="screen" charset="utf-8" />
<link rel="stylesheet" href="http://fonts.googleapis.com/css?family=Nobile:regular,italic,bold,bolditalic&amp;subset=latin" type="text/css" media="screen" charset="utf-8" />
<!--[if lte IE 6]>
<link rel="stylesheet" href="_static/ie6.css" type="text/css" media="screen" charset="utf-8" />
<![endif]-->

  </head>
  <body>

    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="._part0006_main_bitgit.html" title="Using Mercurial"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="._part0004_main_bitgit.html" title="GitHub"
             accesskey="P">previous</a> |</li>
        <li><a href="index.html">Quick Intro to Version Control Systems (Git and Mercurial) and Project Hosting Services</a> &raquo;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <div class="section" id="using-git">
<span id="bitgit-git"></span><h1>Using Git<a class="headerlink" href="#using-git" title="Permalink to this headline">¶</a></h1>
<p id="index-0">Most Mac and Linux users prefer to work with Git via commands in a
terminal window. Windows users may prefer a graphical user interface (GUI),
and there are many <a class="reference external" href="http://git-scm.com/downloads/guis">options</a> in
this respect. There are also GUIs for Mac users.
Here we concentrate on the efficient command-line interface to Git.</p>
<div class="section" id="basic-git-commands">
<h2>Basic Git commands<a class="headerlink" href="#basic-git-commands" title="Permalink to this headline">¶</a></h2>
<div class="section" id="cloning-1">
<span id="index-1"></span><h3>Cloning  (1)<a class="headerlink" href="#cloning-1" title="Permalink to this headline">¶</a></h3>
<p>You get started with your project on a new machine, or another user
can get started with the project,
by running</p>
<div class="highlight-console"><div class="highlight"><pre><span class="go">Terminal&gt; git clone git@github.com:user/My-Project.git</span>
<span class="go">Terminal&gt; cd My-Project</span>
<span class="go">ls</span>
</pre></div>
</div>
<p>Recall to replace <tt class="docutils literal"><span class="pre">user</span></tt> by your real username and <tt class="docutils literal"><span class="pre">My-Project</span></tt> by the
actual project name.</p>
<span class="target" id="index-2"></span><span class="target" id="index-3"></span><span class="target" id="index-4"></span><span class="target" id="index-5"></span><span class="target" id="index-6"></span></div>
<div class="section" id="the-pull-change-push-cycle-1">
<span id="index-7"></span><h3>The pull-change-push cycle  (1)<a class="headerlink" href="#the-pull-change-push-cycle-1" title="Permalink to this headline">¶</a></h3>
<p>The typical work flow with the &#8220;My Project&#8221; project starts with
updating the local repository by going to the <tt class="docutils literal"><span class="pre">My-Project</span></tt> directory
and writing</p>
<div class="highlight-console"><div class="highlight"><pre><span class="go">Terminal&gt; git pull origin master</span>
</pre></div>
</div>
<p>You may want to do <tt class="docutils literal"><span class="pre">git</span> <span class="pre">fetch</span></tt> and <tt class="docutils literal"><span class="pre">git</span> <span class="pre">merge</span></tt> instead
of <tt class="docutils literal"><span class="pre">git</span> <span class="pre">pull</span></tt> as explained in the section <a class="reference internal" href="main_bitgit.html#bitgit-git-fetch"><em>Replacing pull by fetch and merge</em></a>,
especially if you work with branches.</p>
<p>You can now edit files, add new files, delete files, or rename files.
Typical commands are</p>
<div class="highlight-console"><div class="highlight"><pre><span class="go">Terminal&gt; git add file1 file2.* dir1 dir2</span>
<span class="go">Terminal&gt; git rm filename</span>
<span class="go">Terminal&gt; git rm -r dirname</span>
<span class="go">Terminal&gt; git mv oldname newname</span>
<span class="go">Terminal&gt; git mv oldname ../newdir</span>
</pre></div>
</div>
<p>When your chunk of work is ready,
it is time to commit your changes (note the <tt class="docutils literal"><span class="pre">-am</span></tt> option):</p>
<div class="highlight-console"><div class="highlight"><pre><span class="go">Terminal&gt; git commit -am &#39;Description of changes.&#39;</span>
</pre></div>
</div>
<p>If typos or errors enter the message, the <tt class="docutils literal"><span class="pre">git</span> <span class="pre">commit</span> <span class="pre">--amend</span></tt> command
can be used to reformulate the message.  Running <tt class="docutils literal"><span class="pre">git</span> <span class="pre">diff</span></tt> prior to
<tt class="docutils literal"><span class="pre">git</span> <span class="pre">commit</span></tt> makes it
easier to formulate descriptive commit messages since this command
gives a listing of all the changes you have made to the files since
the last commit or pull command.</p>
<p>You may perform many commits, to keep track of small changes, before
you push your changes to the global repository:</p>
<div class="highlight-console"><div class="highlight"><pre><span class="go">Terminal&gt; git push origin master</span>
</pre></div>
</div>
<p>It is recommended to push and pull frequently if the work takes place in several
clones of the repo (i.e., there are many users or you work with the
repo on different
computers). Infrequent push and pull easily leads to merge problems
(see the section <a class="reference internal" href="main_bitgit.html#bitgit-git-merge"><em>Merging files with Git</em></a>). Also remember that others
cannot get your changes before they are pushed.</p>
<p id="index-8">To see the status of files, run</p>
<div class="highlight-console"><div class="highlight"><pre><span class="go">Terminal&gt; git status -s</span>
</pre></div>
</div>
<p>Files are marked with different symbols, e.g.,
<tt class="docutils literal"><span class="pre">A</span></tt> for added, <tt class="docutils literal"><span class="pre">M</span></tt> for modified, <tt class="docutils literal"><span class="pre">R</span></tt> for renamed,
and <tt class="docutils literal"><span class="pre">??</span></tt> for not being registered in the repo.</p>
</div>
<div class="section" id="viewing-the-history-of-files-1">
<h3>Viewing the history of files  (1)<a class="headerlink" href="#viewing-the-history-of-files-1" title="Permalink to this headline">¶</a></h3>
<p>A nice graphical tool allows you to view all changes, or just
the latest ones:</p>
<div class="highlight-console"><div class="highlight"><pre><span class="go">Terminal&gt; gitk --all</span>
<span class="go">Terminal&gt; gitk --since=&quot;2 weeks ago&quot;</span>
</pre></div>
</div>
<span class="target" id="index-9"></span><p id="index-10">You can also view changes to all files, some selected ones, or
a subdirectory:</p>
<div class="highlight-console"><div class="highlight"><pre><span class="go">Terminal&gt; git log -p                 # all changes to all files</span>
<span class="go">Terminal&gt; git log -p filename        # changes to a specific file</span>
<span class="go">Terminal&gt; git log --stat --summary   # compact summary</span>
<span class="go">Terminal&gt; git log --stat --summary subdir</span>
</pre></div>
</div>
<p>Adding <tt class="docutils literal"><span class="pre">--follow</span></tt> will print the history of file versions before the
file got its present name.</p>
<p>To show the author who is responsible for the last modification of each
line in the file, use <tt class="docutils literal"><span class="pre">git</span> <span class="pre">blame</span></tt>:</p>
<div class="highlight-console"><div class="highlight"><pre><span class="go">Terminal&gt; git blame filename</span>
<span class="go">Terminal&gt; git blame --since=&quot;1 week&quot; filename</span>
</pre></div>
</div>
<p>A useful command to see the history of who did what, where individual
edits of words are highlighted (<tt class="docutils literal"><span class="pre">--word-diff</span></tt>), is</p>
<div class="highlight-console"><div class="highlight"><pre><span class="go">git log -p --stat --word-diff filename</span>
</pre></div>
</div>
<p>Removed words appear in brackets and added words in curly braces.</p>
<p>Looking for when a particular piece of text entered or left the file,
say the text <tt class="docutils literal"><span class="pre">def</span> <span class="pre">myfunc</span></tt>, one can run</p>
<div class="highlight-console"><div class="highlight"><pre><span class="go">Terminal&gt; git log -p --word-diff --stat -S&#39;def myfunc&#39; filename</span>
</pre></div>
</div>
<p>This is useful to track down particular changes in the files to see when
they occurred and who introduced them. One can also search for regular
expressions instead of exact text: just replace <tt class="docutils literal"><span class="pre">-S</span></tt> by <tt class="docutils literal"><span class="pre">-G</span></tt>.</p>
<span class="target" id="index-11"></span></div>
<div class="section" id="retrieving-old-files-1">
<span id="index-12"></span><h3>Retrieving old files  (1)<a class="headerlink" href="#retrieving-old-files-1" title="Permalink to this headline">¶</a></h3>
<p>Occasionally you need to go back to an earlier version of a file,
say its name is <tt class="docutils literal"><span class="pre">f.py</span></tt>. Start with viewing the history:</p>
<div class="highlight-console"><div class="highlight"><pre><span class="go">Terminal&gt; git log f.py</span>
</pre></div>
</div>
<p>Find a commit candidate from the list that you will compare the
present version to, copy the commit hash (string like
<tt class="docutils literal"><span class="pre">c7673487...</span></tt>), and run</p>
<div class="highlight-console"><div class="highlight"><pre><span class="go">Terminal&gt; git diff c7673487763ec2bb374758fb8e7efefa12f16dea f.py</span>
</pre></div>
</div>
<p>where the long string is the relevant commit hash. You can now view the
differences between the most recent version and the one in
the commit you picked (see the section <a class="reference internal" href="main_bitgit.html#bitgit-git-fetch"><em>Replacing pull by fetch and merge</em></a> for how to
configure the tools used by the <tt class="docutils literal"><span class="pre">git</span> <span class="pre">diff</span></tt> command). If you want to restore the old file, write</p>
<div class="highlight-console"><div class="highlight"><pre><span class="go">Terminal&gt; git checkout c7673487763ec2bb374758fb8e7efefa12f16dea f.py</span>
</pre></div>
</div>
<p>To go back to another version (the most recent one, for instance),
find the commit hash with <tt class="docutils literal"><span class="pre">git</span> <span class="pre">log</span> <span class="pre">f.py</span></tt>, and do <tt class="docutils literal"><span class="pre">get</span> <span class="pre">checkout</span>
<span class="pre">&lt;commit</span> <span class="pre">hash&gt;</span> <span class="pre">f.py</span></tt>.</p>
<p>If <tt class="docutils literal"><span class="pre">f.py</span></tt> changed name from <tt class="docutils literal"><span class="pre">e.py</span></tt> at some point and you want
<tt class="docutils literal"><span class="pre">e.py</span></tt> back, run <tt class="docutils literal"><span class="pre">git</span> <span class="pre">log</span> <span class="pre">--follow</span> <span class="pre">f.py</span></tt> to find the commit
when <tt class="docutils literal"><span class="pre">e.py</span></tt> existed, and do a <tt class="docutils literal"><span class="pre">git</span> <span class="pre">checkout</span> <span class="pre">&lt;commit</span> <span class="pre">hash&gt;</span> <span class="pre">e.py</span></tt>.</p>
<p>Often you just need to <em>view</em> the old file, not replace the current
one by the old one, and then <tt class="docutils literal"><span class="pre">git</span> <span class="pre">show</span></tt> is handy. Unfortunately,
it requires the full path from the root git directory:</p>
<div class="highlight-console"><div class="highlight"><pre><span class="go">Terminal&gt; git show \</span>
<span class="go">          c7673487763ec2bb374758fb8e7efefa12f16dea:dir1/dir2/f.py</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="merging-files-with-git">
<span id="bitgit-git-merge"></span><h2>Merging files with Git<a class="headerlink" href="#merging-files-with-git" title="Permalink to this headline">¶</a></h2>
<p id="index-13">The <tt class="docutils literal"><span class="pre">git</span> <span class="pre">pull</span></tt> command fetches new files from the repository and
tries to perform an automatic merge if there are conflicts between
the local files and the files in the repository. Alternatively,
you may run <tt class="docutils literal"><span class="pre">git</span> <span class="pre">fetch</span></tt> and <tt class="docutils literal"><span class="pre">git</span> <span class="pre">merge</span></tt> to do the same
thing as described in the section <a class="reference internal" href="main_bitgit.html#bitgit-git-fetch"><em>Replacing pull by fetch and merge</em></a>.
We shall now address what do to if the merge goes wrong, which
occasionally happens.</p>
<p>Git will write a message in the terminal window
if the merge is unsuccessful for one or
more files. These files will have to be edited manually.
Merge markers of the type <tt class="docutils literal"><span class="pre">&gt;&gt;&gt;&gt;&gt;</span></tt>, <tt class="docutils literal"><span class="pre">======</span></tt>, and <tt class="docutils literal"><span class="pre">&lt;&lt;&lt;&lt;&lt;</span></tt> have been
inserted by Git to mark sections of a file where the version in the
repository differ from the local version. You must decide which
lines that are to appear in the final, merged version. When done,
perform <tt class="docutils literal"><span class="pre">git</span> <span class="pre">commit</span></tt> and the conflicts are resolved.</p>
<p>Graphical merge tools may ease the process of merging text files.  You
can run <tt class="docutils literal"><span class="pre">git</span> <span class="pre">mergetool</span> <span class="pre">--tool=meld</span></tt> to open the merge tool <tt class="docutils literal"><span class="pre">meld</span></tt> for
every file that needs to be merged (or specify the name of a
particular file). Other popular merge tools supported by Git are
<tt class="docutils literal"><span class="pre">araxis</span></tt>, <tt class="docutils literal"><span class="pre">bc3</span></tt>, <tt class="docutils literal"><span class="pre">diffuse</span></tt>, <tt class="docutils literal"><span class="pre">ecmerge</span></tt>, <tt class="docutils literal"><span class="pre">emerge</span></tt>, <tt class="docutils literal"><span class="pre">gvimdiff</span></tt>, <tt class="docutils literal"><span class="pre">kdiff3</span></tt>,
<tt class="docutils literal"><span class="pre">opendiff</span></tt>, <tt class="docutils literal"><span class="pre">p4merge</span></tt>, <tt class="docutils literal"><span class="pre">tkdiff</span></tt>, <tt class="docutils literal"><span class="pre">tortoisemerge</span></tt>, <tt class="docutils literal"><span class="pre">vimdiff</span></tt>, and
<tt class="docutils literal"><span class="pre">xxdiff</span></tt>.</p>
<p>Below is a Unix shell script illustrating how to make a global
repository in Git, and how two users clone this repository and
perform edits in parallel. There is one file <tt class="docutils literal"><span class="pre">myfile</span></tt> in the
repository.</p>
<div class="highlight-bash"><div class="highlight"><pre><span class="c">#!/bin/sh</span>
<span class="c"># Demo script for exemplifying git and merge</span>

rm -rf tmp1 tmp2 tmp_repo   <span class="c"># Clean up previous runs</span>

mkdir tmp_repo   <span class="c"># Global repository for testing</span>
<span class="nb">cd </span>tmp_repo
git --bare init --shared
<span class="nb">cd</span> ..

<span class="c"># Make a repo that can be pushed to tmp_repo</span>
mkdir _tmp
<span class="nb">cd </span>_tmp
cat &gt; myfile <span class="s">&lt;&lt;EOF</span>
<span class="s">This is a little</span>
<span class="s">test file for</span>
<span class="s">exemplifying merge</span>
<span class="s">of files in different</span>
<span class="s">git directories.</span>
<span class="s">EOF</span>
git init
git add .   <span class="c"># Add all files not mentioned in ~/.gitignore</span>
git commit -am <span class="s1">&#39;first commit&#39;</span>
git push ../tmp_repo master
<span class="nb">cd</span> ..
rm -rf _tmp

<span class="c"># Make a new hg repositories tmp1 and tmp2 (two users)</span>
git clone tmp_repo tmp1
git clone tmp_repo tmp2
<span class="c"># Change myfile in the directory tmp1</span>
<span class="nb">cd </span>tmp1
<span class="c"># Edit myfile: insert a new second line</span>
perl -pi -e <span class="s1">&#39;s/a little\n/a little\ntmp1-add1\n/g&#39;</span> myfile
<span class="c"># Register change in local repository</span>
git commit -am <span class="s1">&#39;Inserted a new second line in myfile.&#39;</span>
<span class="c"># Look at changes in this clone</span>
git log -p
<span class="c"># or a more compact summary</span>
git log --stat --summary
<span class="c"># or graphically</span>
<span class="c">#gitk</span>
<span class="c"># Register change in global repository tmp_repo</span>
git push origin master
<span class="nb">cd</span> ..

<span class="c"># Change myfile in the directory tmp2 &quot;in parallel&quot;</span>
<span class="nb">cd </span>tmp2
<span class="c"># Edit myfile: add a line at the end</span>
cat &gt;&gt; myfile <span class="s">&lt;&lt;EOF</span>
<span class="s">tmp2-add1</span>
<span class="s">EOF</span>
<span class="c"># Register change locally</span>
git commit -am <span class="s1">&#39;Added a new line at the end&#39;</span>
<span class="c"># Register change globally</span>
git push origin master
<span class="c"># Error message: global repository has changed,</span>
<span class="c"># we need to pull those changes to local repository first</span>
<span class="c"># and see if all files are compatible before we can update</span>
<span class="c"># our own changes to the global repository.</span>
<span class="c"># git writes</span>
<span class="c">#To /home/hpl/vc/scripting/manu/py/bitgit/src-bitgit/tmp_repo</span>
<span class="c"># ! [rejected]        master -&gt; master (non-fast-forward)</span>
<span class="c">#error: failed to push some refs to ...</span>

git pull origin master
<span class="c"># git writes:</span>
<span class="c">#Auto-merging myfile</span>
<span class="c">#Merge made by recursive.</span>
<span class="c"># myfile |    1 +</span>
<span class="c"># 1 files changed, 1 insertions(+), 0 deletions(-)</span>
cat myfile  <span class="c"># successful merge!</span>
git commit -am merge
git push origin master
<span class="nb">cd</span> ..

<span class="c"># Perform new changes in parallel in tmp1 and tmp2,</span>
<span class="c"># this time causing hg merge to fail</span>

<span class="c"># Change myfile in the directory tmp1</span>
<span class="nb">cd </span>tmp1
<span class="c"># Do it all right by pulling and updating first</span>
git pull origin master
<span class="c"># Edit myfile: insert &quot;just&quot; in first line.</span>
perl -pi -e <span class="s1">&#39;s/a little/tmp1-add2 a little/g&#39;</span> myfile
<span class="c"># Register change in local repository</span>
git commit -am <span class="s1">&#39;Inserted &quot;just&quot; in first line.&#39;</span>
<span class="c"># Register change in global repository tmp_repo</span>
git push origin master
<span class="nb">cd</span> ..

<span class="c"># Change myfile in the directory tmp2 &quot;in parallel&quot;</span>
<span class="nb">cd </span>tmp2
<span class="c"># Edit myfile: replace little by modest</span>
perl -pi -e <span class="s1">&#39;s/a little/a tmp2-replace1\ntmp2-add2\n/g&#39;</span> myfile
<span class="c"># Register change locally</span>
git commit -am <span class="s1">&#39;Replaced &quot;little&quot; by &quot;modest&quot;&#39;</span>
<span class="c"># Register change globally</span>
git push origin master
<span class="c"># Not possible: need to pull changes in the global repository</span>
git pull origin master
<span class="c"># git writes</span>
<span class="c">#CONFLICT (content): Merge conflict in myfile</span>
<span class="c">#Automatic merge failed; fix conflicts and then commit the result.</span>
<span class="c"># we have to do a manual merge</span>
cat myfile
<span class="nb">echo</span> <span class="s1">&#39;Now you must edit myfile manually&#39;</span>
</pre></div>
</div>
<p>You may run this file <a class="reference external" href="http://hplgit.github.com/teamods/bitgit/_static-bitgit/git_merge.sh">git_merge.sh</a> named
by <tt class="docutils literal"><span class="pre">sh</span> <span class="pre">-x</span> <span class="pre">git_merge.sh</span></tt>.
At the end, the versions of <tt class="docutils literal"><span class="pre">myfile</span></tt> in the
repository and the <tt class="docutils literal"><span class="pre">tmp2</span></tt> directory are in conflict. Git tried
to merge the two versions, but failed. Merge markers are left in
<tt class="docutils literal"><span class="pre">tmp2/myfile</span></tt>:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="o">&lt;&lt;&lt;&lt;&lt;&lt;&lt;</span> <span class="n">HEAD</span>
<span class="n">This</span> <span class="ow">is</span> <span class="n">a</span> <span class="n">tmp2</span><span class="o">-</span><span class="n">replace1</span>
<span class="n">tmp2</span><span class="o">-</span><span class="n">add2</span>

<span class="o">=======</span>
<span class="n">This</span> <span class="ow">is</span> <span class="n">tmp1</span><span class="o">-</span><span class="n">add2</span> <span class="n">a</span> <span class="n">little</span>
<span class="o">&gt;&gt;&gt;&gt;&gt;&gt;&gt;</span> <span class="n">ad9b9f631c4cc586ea951390d9415ac83bcc9c01</span>
<span class="n">tmp1</span><span class="o">-</span><span class="n">add1</span>
<span class="n">test</span> <span class="nb">file</span> <span class="k">for</span>
<span class="n">exemplifying</span> <span class="n">merge</span>
<span class="n">of</span> <span class="n">files</span> <span class="ow">in</span> <span class="n">different</span>
<span class="n">git</span> <span class="n">directories</span><span class="o">.</span>
<span class="n">tmp2</span><span class="o">-</span><span class="n">add1</span>
</pre></div>
</div>
<p>Launch a text editor and edit the file, or use <tt class="docutils literal"><span class="pre">git</span> <span class="pre">mergetool</span></tt>,
so that the file becomes correct.
Then run <tt class="docutils literal"><span class="pre">git</span> <span class="pre">commit</span> <span class="pre">-am</span> <span class="pre">merge</span></tt> to finalize the merge.</p>
</div>
<div class="section" id="git-working-style-with-branching-and-stashing">
<span id="bitgit-git-branch-stash"></span><h2>Git working style with branching and stashing<a class="headerlink" href="#git-working-style-with-branching-and-stashing" title="Permalink to this headline">¶</a></h2>
<p>Branching and stashing are nice features of Git that allow you to try
out new things without affecting the stable version of your files.
Usually, you extend and modify files quite often and perform a <tt class="docutils literal"><span class="pre">git</span>
<span class="pre">commit</span></tt> every time you want to record the changes in your local
repository. Imagine that you want to correct a set of errors in some
files and push these corrections immediately.  The problem is that
such a push will also include the latest, yet unfinished files that you
have committed.</p>
<p>A better organization of your work would
be to keep the latest, ongoing
developments separate from the more official and stable version
of the files. This is easily achieved by creating a separate branch
where new developments takes place:</p>
<div class="highlight-console"><div class="highlight"><pre><span class="go">Terminal&gt; git branch newstuff      # create and switch to new branch</span>
<span class="go">Terminal&gt; # extend and modify files...</span>
<span class="go">Terminal&gt; git commit -am &#39;Modified ... Added a file on ...&#39;</span>
<span class="go">Terminal&gt; git checkout master      # swith back to master</span>
<span class="go">Terminal&gt; # correct errors</span>
<span class="go">Terminal&gt; git push origin master</span>
<span class="go">Terminal&gt; git checkout newstuff    # switch to other branch</span>
<span class="go">Terminal&gt; git merge master         # keep branch up-to-date w/master</span>
<span class="go">Terminal&gt; # continue development work...</span>
<span class="go">Terminal&gt; git commit -am &#39;More modifications of ...&#39;</span>
</pre></div>
</div>
<p>At some point, your developments in <tt class="docutils literal"><span class="pre">newstuff</span></tt>
are mature enough to be incorporated
in the master branch:</p>
<div class="highlight-console"><div class="highlight"><pre><span class="go">Terminal&gt; git checkout newstuff</span>
<span class="go">Terminal&gt; git merge master        # synchronize newstuff w/master</span>
<span class="go">Terminal&gt; git checkout master</span>
<span class="go">Terminal&gt; git merge newstuff      # synchronize master w/newstuff</span>
</pre></div>
</div>
<p>You no longer need the <tt class="docutils literal"><span class="pre">newstuff</span></tt> branch and can delete it:</p>
<div class="highlight-console"><div class="highlight"><pre><span class="go">Terminal&gt; git branch -d newstuff</span>
</pre></div>
</div>
<p>It is not possible to switch branches unless you have committed the
files in the current branch. If your work on some files is in a mess
and you want to change to another branch or fix other files in the
current branch, a
&#8220;global&#8221; commit affecting all files might be immature.  Then the <a class="reference external" href="http://git-scm.com/book/en/Git-Tools-Stashing">git stash</a> command is handy. It
records the state of your files and sets you back to the state of the
last commit in the current branch. With <tt class="docutils literal"><span class="pre">git</span> <span class="pre">stash</span> <span class="pre">apply</span></tt> you get the
files in this branch back to the state when you did the last <tt class="docutils literal"><span class="pre">git</span>
<span class="pre">stash</span></tt>.</p>
<p>Let us explain a typical case.  Suppose you have performed some
extensive edits in some files and then you are suddenly
interrupted. You need to fix some typos in some other files, commit
the changes, and push. The problem is that many files are in an
unfinished state - in hindsight you realize that those files should
have been modified in a separate branch.  It is not too late to create
that branch! First run <tt class="docutils literal"><span class="pre">git</span> <span class="pre">stash</span></tt> to get the files back to the state
they were at the last commit. Then run <tt class="docutils literal"><span class="pre">git</span> <span class="pre">stash</span> <span class="pre">branch</span> <span class="pre">newstuff</span></tt> to
create a new branch <tt class="docutils literal"><span class="pre">newstuff</span></tt> containing the state of the files when
you did the (last) <tt class="docutils literal"><span class="pre">git</span> <span class="pre">stash</span></tt> command.  Stashing used this way is a
convenient technique to move some immature edits after the last commit
out in a new branch for further experimental work.</p>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">You can get the stashed files back by <tt class="docutils literal"><span class="pre">git</span> <span class="pre">stash</span> <span class="pre">apply</span></tt>. It is
possible to multiple <tt class="docutils literal"><span class="pre">git</span> <span class="pre">stash</span></tt> and <tt class="docutils literal"><span class="pre">git</span> <span class="pre">stash</span> <span class="pre">apply</span></tt>
commands. However, it is easy to run into trouble with multiple
stashes, especially if they occur in multiple branches, as it becomes
difficult to recognize which stashes that belong to which branch.  A
good advice is therefore to do <tt class="docutils literal"><span class="pre">git</span> <span class="pre">stash</span></tt> <em>only once</em> to get back to
a clean state and then move the unfinished messy files to a separate
branch with <tt class="docutils literal"><span class="pre">git</span> <span class="pre">stash</span> <span class="pre">branch</span> <span class="pre">newstuff</span></tt>.</p>
</div>
</div>
<div class="section" id="replacing-pull-by-fetch-and-merge">
<span id="bitgit-git-fetch"></span><h2>Replacing pull by fetch and merge<a class="headerlink" href="#replacing-pull-by-fetch-and-merge" title="Permalink to this headline">¶</a></h2>
<p>The <tt class="docutils literal"><span class="pre">git</span> <span class="pre">pull</span></tt> command actually performs two steps that are sometimes
advantageous to run separately. First, a <tt class="docutils literal"><span class="pre">get</span> <span class="pre">fetch</span></tt> is run to fetch
new files from the repository, and thereafter a <tt class="docutils literal"><span class="pre">git</span> <span class="pre">merge</span></tt> command is
run to merge the new files with your local version of the files.
While <tt class="docutils literal"><span class="pre">git</span> <span class="pre">pull</span></tt> tries to do a lot and be smart in the merge, very
often with success, the merge step may occasionally lead to
trouble. That is why it is recommended to run a <tt class="docutils literal"><span class="pre">git</span> <span class="pre">merge</span></tt>
separately, especially if you work with branches.</p>
<p>To fetch files from your repository at GitHub, which usually has
the nickname <tt class="docutils literal"><span class="pre">origin</span></tt>, you write</p>
<div class="highlight-console"><div class="highlight"><pre><span class="go">Terminal&gt; git fetch origin</span>
</pre></div>
</div>
<p>You now have the possibility to check out in detail what the differences
are between the new files and local ones:</p>
<div class="highlight-console"><div class="highlight"><pre><span class="go">Terminal&gt; git diff origin/master</span>
</pre></div>
</div>
<p>This command produces comparisons of the files in the current local branch
and the <tt class="docutils literal"><span class="pre">master</span></tt> branch at <tt class="docutils literal"><span class="pre">origin</span></tt> (the GitHub repo).
In this way you can exactly see the differences between branches.
It also gives you an overview of what others have done with
the files.
When you are ready to merge in the new files from the <tt class="docutils literal"><span class="pre">master</span></tt> branch
of <tt class="docutils literal"><span class="pre">origin</span></tt> with the files in the current local branch, you say</p>
<div class="highlight-console"><div class="highlight"><pre><span class="go">Terminal&gt; git merge origin/master</span>
</pre></div>
</div>
<div class="section" id="configuring-the-git-diff-command">
<h3>Configuring the <tt class="docutils literal"><span class="pre">git</span> <span class="pre">diff</span></tt> command<a class="headerlink" href="#configuring-the-git-diff-command" title="Permalink to this headline">¶</a></h3>
<p>The <tt class="docutils literal"><span class="pre">git</span> <span class="pre">diff</span></tt> command launches by default the
Unix <tt class="docutils literal"><span class="pre">diff</span></tt> tool in the terminal window.
Many users prefer to use other diff tools, and the desired one
can be specified in
your <tt class="docutils literal"><span class="pre">~/.gitconfig</span></tt> file. However, a much recommended approach is to
wrap a shell script around the call to the diff program, because
<tt class="docutils literal"><span class="pre">git</span> <span class="pre">diff</span></tt> actually calls the diff program with a series of
command-line arguments that will confuse diff programs that take
the names of the two files to be compared as arguments.
In <tt class="docutils literal"><span class="pre">~/.gitconfig</span></tt> you specify a script to do the diff:</p>
<div class="highlight-text"><div class="highlight"><pre>[diff]
external = ~/bin/git-diff-wrapper.sh
</pre></div>
</div>
<p>It remains to write the <tt class="docutils literal"><span class="pre">git-diff-wrapper.sh</span></tt> script.
The  2nd and 5th command-line arguments passed to this script are the
name of the files to be compared in the diff. A typical script may
therefore look like</p>
<div class="highlight-bash"><div class="highlight"><pre><span class="c">#!/bin/sh</span>

diff <span class="s2">&quot;$2&quot;</span> <span class="s2">&quot;$5&quot;</span> | less
</pre></div>
</div>
<p>Here we use the standard (and quite primitive) Unix <tt class="docutils literal"><span class="pre">diff</span></tt> program,
but we can replace <tt class="docutils literal"><span class="pre">diff</span></tt> by, e.g., <tt class="docutils literal"><span class="pre">diffuse</span></tt>, <tt class="docutils literal"><span class="pre">kdiff3</span></tt>, <tt class="docutils literal"><span class="pre">xxdiff</span></tt>, <tt class="docutils literal"><span class="pre">meld</span></tt>, <tt class="docutils literal"><span class="pre">pdiff</span></tt>, or others. With a Python script you can easily check
for the extensions of the files and use different diff tools for
different types of files, e.g., <tt class="docutils literal"><span class="pre">latexdiff</span></tt> for LaTeX files
and <tt class="docutils literal"><span class="pre">pdiff</span></tt> for pure text files.</p>
<div class="admonition-replacing-all-your-files-with-those-in-the-repo admonition">
<p class="first admonition-title">Replacing all your files with those in the repo</p>
<p>Occasionally it becomes desirable to replace <em>all</em> files in
the local repo with those at the file hosting service.
One possibility is removing your repo and cloning again, or
use the Git commands</p>
<div class="last highlight-console"><div class="highlight"><pre><span class="go">Terminal&gt; git fetch --all</span>
<span class="go">Terminal&gt; git reset --hard origin/master</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="team-work-with-forking-and-pull-requests">
<span id="bitgit-git-team"></span><h2>Team work with forking and pull requests<a class="headerlink" href="#team-work-with-forking-and-pull-requests" title="Permalink to this headline">¶</a></h2>
<span class="target" id="index-14"></span><span class="target" id="index-15"></span><span class="target" id="index-16"></span><p id="index-17">In small collaboration teams it is natural that everyone has push access
to the repo. On GitHub this is known as the <em>Shared Repository Model</em>.
As teams grow larger, there will usually be a few
people in charge who should approve changes to the files. Ordinary team members
will in this case not clone a repo and push changes, but instead
<em>fork</em> the repo and send <em>pull requests</em>, which constitutes the
<em>Fork and Pull Model</em>.</p>
<p>Say you want to fork the repo <tt class="docutils literal"><span class="pre">https://github.com/somebody/proj1.git</span></tt>.
The first step is to press the <em>Fork</em> button on the project page for
the <tt class="docutils literal"><span class="pre">somebody/proj1</span></tt> project on GitHub.
This action creates a new repo <tt class="docutils literal"><span class="pre">proj1</span></tt>, known as the forked repo,
on your GitHub account.
Clone the fork as you clone any repo:</p>
<div class="highlight-console"><div class="highlight"><pre><span class="go">Terminal&gt; git clone https://github.com/user/proj1.git</span>
</pre></div>
</div>
<p>When you do <tt class="docutils literal"><span class="pre">git</span> <span class="pre">push</span> <span class="pre">origin</span> <span class="pre">master</span></tt>, you update your fork.
However, the original
repo is usually under development too, and you need to pull from that
one to stay up to date. A <tt class="docutils literal"><span class="pre">git</span> <span class="pre">pull</span> <span class="pre">origin</span> <span class="pre">master</span></tt> pulls from
<tt class="docutils literal"><span class="pre">origin</span></tt> which is your fork. To pull from the original repo, you
create a name <tt class="docutils literal"><span class="pre">upstream</span></tt>,</p>
<div class="highlight-console"><div class="highlight"><pre><span class="go">Terminal&gt; git remote add upstream \</span>
<span class="go">              https://github.com/somebody/proj1.git</span>
</pre></div>
</div>
<p>You can now do <tt class="docutils literal"><span class="pre">git</span> <span class="pre">pull</span> <span class="pre">upstream</span></tt> to get the most recent files in
the original repo. However,
it is not recommended to do a pull this way
because heavy development of the <tt class="docutils literal"><span class="pre">sombody/proj1</span></tt> project may
lead to serious merge problems.
It is much better to replace the pull by a separate
<em>fetch</em> and <em>merge</em>.
The typical workflow is</p>
<div class="highlight-console"><div class="highlight"><pre><span class="go">Terminal&gt; git fetch upstream           # get new version of files</span>
<span class="go">Terminal&gt; git merge upstream/master    # merge with yours</span>
<span class="go">Terminal&gt; # Your files are up to date - ready for editing</span>
<span class="go">Terminal&gt; git commit -am &#39;Description...&#39;</span>
<span class="go">Terminal&gt; git push origin master       # store changes in your fork</span>
</pre></div>
</div>
<p>At some point you would like to push your changes back to the original
repo <tt class="docutils literal"><span class="pre">somebody/proj1</span></tt>. This is done by a <a class="reference external" href="https://help.github.com/articles/using-pull-requests">pull request</a>. Make sure you
have selected the right branch on the project page of your forked
project. Press the <em>Pull Request</em> button and fill out the form that
pops up.  Trusted people in the <tt class="docutils literal"><span class="pre">somebody/proj1</span></tt> project will now
review your changes and if they are approved, your files are merged
into the original repo. If not, there are tools for keeping a dialog
about how to proceed.</p>
<p>Also in small teams where everyone has push access, the fork and pull
request model is beneficial for reviewing files before the repo
is actually updated with new contributions.</p>
</div>
<div class="section" id="git-workflows">
<h2>Git workflows<a class="headerlink" href="#git-workflows" title="Permalink to this headline">¶</a></h2>
<p>Although the purpose of these notes is just to get the reader started
with Git, it must be mentioned that there are advanced features of Git
that have led to very powerful workflows with files and people,
especially for software development.  There is an official <a class="reference external" href="https://www.kernel.org/pub/software/scm/git/docs/gitworkflows.html">Git
workflow model</a>
that outlines the basic principles, but it can be quite advanced for
those with modest Git knowledge.  A more detailed explanation of a
recommended workflow for beginners is given in the <a class="reference external" href="https://bitbucket.org/petsc/petsc/wiki/developer-instructions-git">developer
instructions</a>
for the software package PETSc. This is highly suggested reading.  The
associated &#8220;quick summary&#8221; of Git commands for their workflow is also
useful.</p>
</div>
<div class="section" id="more-documentation-on-git">
<h2>More documentation on Git<a class="headerlink" href="#more-documentation-on-git" title="Permalink to this headline">¶</a></h2>
<blockquote>
<div><ul class="simple">
<li><a class="reference external" href="http://try.github.com/">Web course on Git</a></li>
<li><a class="reference external" href="http://schacon.github.com/git/everyday.html">Everyday GIT With 20 Commands Or So</a></li>
<li><a class="reference external" href="http://sixrevisions.com/resources/git-tutorials-beginners/">Git top 10 tutorials</a></li>
<li><a class="reference external" href="http://www.vogella.com/articles/Git/article.html">Lars Vogel&#8217;s Git Tutorial</a></li>
<li><a class="reference external" href="http://book.git-scm.com/">Git Community Book</a> (<em>explains</em> Git very well)</li>
<li><a class="reference external" href="http://hoth.entp.com/output/git_for_designers.html">Git for Designers</a> (aimed a people with no previous knowledge of version control systems)</li>
<li><a class="reference external" href="http://www-cs-students.stanford.edu/~blynn/gitmagic/ch02.html">Git Magic: Basic Tricks</a></li>
<li>The official <a class="reference external" href="http://schacon.github.com/git/gittutorial.html">Git Tutorial</a></li>
<li><a class="reference external" href="http://www.youtube.com/watch?v=TPY8UwlTIc0&amp;feature=related">Git Tutorial Video</a> on YouTube</li>
<li><a class="reference external" href="http://wiki.sourcemage.org/Git_Guide">Git Questions</a></li>
<li><a class="reference external" href="http://gitref.org">Git Reference</a> (can also be used as a tutorial on Git)</li>
<li><a class="reference external" href="http://schacon.github.com/git/user-manual.html">Git User Manual</a></li>
<li><a class="reference external" href="http://git-scm.com/">Git home page</a></li>
<li><a class="reference external" href="http://mercurial.selenic.com/wiki/GitConcepts#Command_equivalence_table">Git and Mercurial command equivalence table</a></li>
<li><a class="reference external" href="http://git-scm.com/downloads/guis">Git/GitHub GUIs on Windows and Mac</a></li>
</ul>
</div></blockquote>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
  <h3><a href="index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">Using Git</a><ul>
<li><a class="reference internal" href="#basic-git-commands">Basic Git commands</a><ul>
<li><a class="reference internal" href="#cloning-1">Cloning  (1)</a></li>
<li><a class="reference internal" href="#the-pull-change-push-cycle-1">The pull-change-push cycle  (1)</a></li>
<li><a class="reference internal" href="#viewing-the-history-of-files-1">Viewing the history of files  (1)</a></li>
<li><a class="reference internal" href="#retrieving-old-files-1">Retrieving old files  (1)</a></li>
</ul>
</li>
<li><a class="reference internal" href="#merging-files-with-git">Merging files with Git</a></li>
<li><a class="reference internal" href="#git-working-style-with-branching-and-stashing">Git working style with branching and stashing</a></li>
<li><a class="reference internal" href="#replacing-pull-by-fetch-and-merge">Replacing pull by fetch and merge</a><ul>
<li><a class="reference internal" href="#configuring-the-git-diff-command">Configuring the <tt class="docutils literal"><span class="pre">git</span> <span class="pre">diff</span></tt> command</a></li>
</ul>
</li>
<li><a class="reference internal" href="#team-work-with-forking-and-pull-requests">Team work with forking and pull requests</a></li>
<li><a class="reference internal" href="#git-workflows">Git workflows</a></li>
<li><a class="reference internal" href="#more-documentation-on-git">More documentation on Git</a></li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="._part0004_main_bitgit.html"
                        title="previous chapter">GitHub</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="._part0006_main_bitgit.html"
                        title="next chapter">Using Mercurial</a></p>
<div id="searchbox" style="display: none">
  <h3>Quick search</h3>
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" size="18" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="._part0006_main_bitgit.html" title="Using Mercurial"
             >next</a> |</li>
        <li class="right" >
          <a href="._part0004_main_bitgit.html" title="GitHub"
             >previous</a> |</li>
        <li><a href="index.html">Quick Intro to Version Control Systems (Git and Mercurial) and Project Hosting Services</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer">
        &copy; Copyright 2013, H. P. Langtangen.
      Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 1.1.3.
    </div>
  </body>
</html>